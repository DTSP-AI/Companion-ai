"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunk_N_E"] = self["webpackChunk_N_E"] || []).push([["_app-pages-browser_node_modules_langchain_dist_chains_sequential_chain_js"],{

/***/ "(app-pages-browser)/./node_modules/langchain/dist/chains/sequential_chain.js":
/*!****************************************************************!*\
  !*** ./node_modules/langchain/dist/chains/sequential_chain.js ***!
  \****************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SequentialChain: function() { return /* binding */ SequentialChain; },\n/* harmony export */   SimpleSequentialChain: function() { return /* binding */ SimpleSequentialChain; }\n/* harmony export */ });\n/* harmony import */ var _base_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./base.js */ \"(app-pages-browser)/./node_modules/langchain/dist/chains/base.js\");\n/* harmony import */ var _util_set_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../util/set.js */ \"(app-pages-browser)/./node_modules/langchain/dist/util/set.js\");\n\n\nfunction formatSet(input) {\n    return Array.from(input)\n        .map((i) => `\"${i}\"`)\n        .join(\", \");\n}\n/**\n * Chain where the outputs of one chain feed directly into next.\n * @example\n * ```typescript\n * const promptTemplate = new PromptTemplate({\n *   template: `You are a playwright. Given the title of play and the era it is set in, it is your job to write a synopsis for that title.\n * Title: {title}\n * Era: {era}\n * Playwright: This is a synopsis for the above play:`,\n *   inputVariables: [\"title\", \"era\"],\n * });\n\n * const reviewPromptTemplate = new PromptTemplate({\n *   template: `You are a play critic from the New York Times. Given the synopsis of play, it is your job to write a review for that play.\n *\n *     Play Synopsis:\n *     {synopsis}\n *     Review from a New York Times play critic of the above play:`,\n *   inputVariables: [\"synopsis\"],\n * });\n\n * const overallChain = new SequentialChain({\n *   chains: [\n *     new LLMChain({\n *       llm: new ChatOpenAI({ temperature: 0 }),\n *       prompt: promptTemplate,\n *       outputKey: \"synopsis\",\n *     }),\n *     new LLMChain({\n *       llm: new OpenAI({ temperature: 0 }),\n *       prompt: reviewPromptTemplate,\n *       outputKey: \"review\",\n *     }),\n *   ],\n *   inputVariables: [\"era\", \"title\"],\n *   outputVariables: [\"synopsis\", \"review\"],\n *   verbose: true,\n * });\n\n * const chainExecutionResult = await overallChain.call({\n *   title: \"Tragedy at sunset on the beach\",\n *   era: \"Victorian England\",\n * });\n * console.log(chainExecutionResult);\n * ```\n *\n * @deprecated\n * Switch to {@link https://js.langchain.com/docs/expression_language/ | expression language}.\n * Will be removed in 0.2.0\n */\nclass SequentialChain extends _base_js__WEBPACK_IMPORTED_MODULE_0__.BaseChain {\n    static lc_name() {\n        return \"SequentialChain\";\n    }\n    get inputKeys() {\n        return this.inputVariables;\n    }\n    get outputKeys() {\n        return this.outputVariables;\n    }\n    constructor(fields) {\n        super(fields);\n        Object.defineProperty(this, \"chains\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"inputVariables\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"outputVariables\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"returnAll\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this.chains = fields.chains;\n        this.inputVariables = fields.inputVariables;\n        this.outputVariables = fields.outputVariables ?? [];\n        if (this.outputVariables.length > 0 && fields.returnAll) {\n            throw new Error(\"Either specify variables to return using `outputVariables` or use `returnAll` param. Cannot apply both conditions at the same time.\");\n        }\n        this.returnAll = fields.returnAll ?? false;\n        this._validateChains();\n    }\n    /** @ignore */\n    _validateChains() {\n        if (this.chains.length === 0) {\n            throw new Error(\"Sequential chain must have at least one chain.\");\n        }\n        const memoryKeys = this.memory?.memoryKeys ?? [];\n        const inputKeysSet = new Set(this.inputKeys);\n        const memoryKeysSet = new Set(memoryKeys);\n        const keysIntersection = (0,_util_set_js__WEBPACK_IMPORTED_MODULE_1__.intersection)(inputKeysSet, memoryKeysSet);\n        if (keysIntersection.size > 0) {\n            throw new Error(`The following keys: ${formatSet(keysIntersection)} are overlapping between memory and input keys of the chain variables. This can lead to unexpected behaviour. Please use input and memory keys that don't overlap.`);\n        }\n        const availableKeys = (0,_util_set_js__WEBPACK_IMPORTED_MODULE_1__.union)(inputKeysSet, memoryKeysSet);\n        for (const chain of this.chains) {\n            let missingKeys = (0,_util_set_js__WEBPACK_IMPORTED_MODULE_1__.difference)(new Set(chain.inputKeys), availableKeys);\n            if (chain.memory) {\n                missingKeys = (0,_util_set_js__WEBPACK_IMPORTED_MODULE_1__.difference)(missingKeys, new Set(chain.memory.memoryKeys));\n            }\n            if (missingKeys.size > 0) {\n                throw new Error(`Missing variables for chain \"${chain._chainType()}\": ${formatSet(missingKeys)}. Only got the following variables: ${formatSet(availableKeys)}.`);\n            }\n            const outputKeysSet = new Set(chain.outputKeys);\n            const overlappingOutputKeys = (0,_util_set_js__WEBPACK_IMPORTED_MODULE_1__.intersection)(availableKeys, outputKeysSet);\n            if (overlappingOutputKeys.size > 0) {\n                throw new Error(`The following output variables for chain \"${chain._chainType()}\" are overlapping: ${formatSet(overlappingOutputKeys)}. This can lead to unexpected behaviour.`);\n            }\n            for (const outputKey of outputKeysSet) {\n                availableKeys.add(outputKey);\n            }\n        }\n        if (this.outputVariables.length === 0) {\n            if (this.returnAll) {\n                const outputKeys = (0,_util_set_js__WEBPACK_IMPORTED_MODULE_1__.difference)(availableKeys, inputKeysSet);\n                this.outputVariables = Array.from(outputKeys);\n            }\n            else {\n                this.outputVariables = this.chains[this.chains.length - 1].outputKeys;\n            }\n        }\n        else {\n            const missingKeys = (0,_util_set_js__WEBPACK_IMPORTED_MODULE_1__.difference)(new Set(this.outputVariables), new Set(availableKeys));\n            if (missingKeys.size > 0) {\n                throw new Error(`The following output variables were expected to be in the final chain output but were not found: ${formatSet(missingKeys)}.`);\n            }\n        }\n    }\n    /** @ignore */\n    async _call(values, runManager) {\n        let input = {};\n        const allChainValues = values;\n        let i = 0;\n        for (const chain of this.chains) {\n            i += 1;\n            input = await chain.call(allChainValues, runManager?.getChild(`step_${i}`));\n            for (const key of Object.keys(input)) {\n                allChainValues[key] = input[key];\n            }\n        }\n        const output = {};\n        for (const key of this.outputVariables) {\n            output[key] = allChainValues[key];\n        }\n        return output;\n    }\n    _chainType() {\n        return \"sequential_chain\";\n    }\n    static async deserialize(data) {\n        const chains = [];\n        const inputVariables = data.input_variables;\n        const outputVariables = data.output_variables;\n        const serializedChains = data.chains;\n        for (const serializedChain of serializedChains) {\n            const deserializedChain = await _base_js__WEBPACK_IMPORTED_MODULE_0__.BaseChain.deserialize(serializedChain);\n            chains.push(deserializedChain);\n        }\n        return new SequentialChain({ chains, inputVariables, outputVariables });\n    }\n    serialize() {\n        const chains = [];\n        for (const chain of this.chains) {\n            chains.push(chain.serialize());\n        }\n        return {\n            _type: this._chainType(),\n            input_variables: this.inputVariables,\n            output_variables: this.outputVariables,\n            chains,\n        };\n    }\n}\n/**\n * @deprecated Switch to expression language: https://js.langchain.com/docs/expression_language/\n * Simple chain where a single string output of one chain is fed directly into the next.\n * @augments BaseChain\n * @augments SimpleSequentialChainInput\n *\n * @example\n * ```ts\n * import { SimpleSequentialChain, LLMChain } from \"langchain/chains\";\n * import { OpenAI } from \"langchain/llms/openai\";\n * import { PromptTemplate } from \"langchain/prompts\";\n *\n * // This is an LLMChain to write a synopsis given a title of a play.\n * const llm = new OpenAI({ temperature: 0 });\n * const template = `You are a playwright. Given the title of play, it is your job to write a synopsis for that title.\n *\n * Title: {title}\n * Playwright: This is a synopsis for the above play:`\n * const promptTemplate = new PromptTemplate({ template, inputVariables: [\"title\"] });\n * const synopsisChain = new LLMChain({ llm, prompt: promptTemplate });\n *\n *\n * // This is an LLMChain to write a review of a play given a synopsis.\n * const reviewLLM = new OpenAI({ temperature: 0 })\n * const reviewTemplate = `You are a play critic from the New York Times. Given the synopsis of play, it is your job to write a review for that play.\n *\n * Play Synopsis:\n * {synopsis}\n * Review from a New York Times play critic of the above play:`\n * const reviewPromptTemplate = new PromptTemplate({ template: reviewTemplate, inputVariables: [\"synopsis\"] });\n * const reviewChain = new LLMChain({ llm: reviewLLM, prompt: reviewPromptTemplate });\n *\n * const overallChain = new SimpleSequentialChain({chains: [synopsisChain, reviewChain], verbose:true})\n * const review = await overallChain.run(\"Tragedy at sunset on the beach\")\n * // the variable review contains resulting play review.\n * ```\n */\nclass SimpleSequentialChain extends _base_js__WEBPACK_IMPORTED_MODULE_0__.BaseChain {\n    static lc_name() {\n        return \"SimpleSequentialChain\";\n    }\n    get inputKeys() {\n        return [this.inputKey];\n    }\n    get outputKeys() {\n        return [this.outputKey];\n    }\n    constructor(fields) {\n        super(fields);\n        Object.defineProperty(this, \"chains\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"inputKey\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"input\"\n        });\n        Object.defineProperty(this, \"outputKey\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"output\"\n        });\n        Object.defineProperty(this, \"trimOutputs\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this.chains = fields.chains;\n        this.trimOutputs = fields.trimOutputs ?? false;\n        this._validateChains();\n    }\n    /** @ignore */\n    _validateChains() {\n        for (const chain of this.chains) {\n            if (chain.inputKeys.filter((k) => !chain.memory?.memoryKeys.includes(k) ?? true).length !== 1) {\n                throw new Error(`Chains used in SimpleSequentialChain should all have one input, got ${chain.inputKeys.length} for ${chain._chainType()}.`);\n            }\n            if (chain.outputKeys.length !== 1) {\n                throw new Error(`Chains used in SimpleSequentialChain should all have one output, got ${chain.outputKeys.length} for ${chain._chainType()}.`);\n            }\n        }\n    }\n    /** @ignore */\n    async _call(values, runManager) {\n        let input = values[this.inputKey];\n        let i = 0;\n        for (const chain of this.chains) {\n            i += 1;\n            input = (await chain.call({ [chain.inputKeys[0]]: input, signal: values.signal }, runManager?.getChild(`step_${i}`)))[chain.outputKeys[0]];\n            if (this.trimOutputs) {\n                input = input.trim();\n            }\n            await runManager?.handleText(input);\n        }\n        return { [this.outputKey]: input };\n    }\n    _chainType() {\n        return \"simple_sequential_chain\";\n    }\n    static async deserialize(data) {\n        const chains = [];\n        const serializedChains = data.chains;\n        for (const serializedChain of serializedChains) {\n            const deserializedChain = await _base_js__WEBPACK_IMPORTED_MODULE_0__.BaseChain.deserialize(serializedChain);\n            chains.push(deserializedChain);\n        }\n        return new SimpleSequentialChain({ chains });\n    }\n    serialize() {\n        const chains = [];\n        for (const chain of this.chains) {\n            chains.push(chain.serialize());\n        }\n        return {\n            _type: this._chainType(),\n            chains,\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC9jaGFpbnMvc2VxdWVudGlhbF9jaGFpbi5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQXNDO0FBQzJCO0FBQ2pFO0FBQ0E7QUFDQSx3QkFBd0IsRUFBRTtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYLFNBQVM7QUFDVDtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsZ0JBQWdCO0FBQy9DO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQSwyQkFBMkIsZ0JBQWdCO0FBQzNDO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsK0VBQStFO0FBQzdGO0FBQ0E7QUFDTyw4QkFBOEIsK0NBQVM7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQywwREFBWTtBQUM3QztBQUNBLG1EQUFtRCw2QkFBNkI7QUFDaEY7QUFDQSw4QkFBOEIsbURBQUs7QUFDbkM7QUFDQSw4QkFBOEIsd0RBQVU7QUFDeEM7QUFDQSw4QkFBOEIsd0RBQVU7QUFDeEM7QUFDQTtBQUNBLGdFQUFnRSxtQkFBbUIsS0FBSyx1QkFBdUIsc0NBQXNDLHlCQUF5QjtBQUM5SztBQUNBO0FBQ0EsMENBQTBDLDBEQUFZO0FBQ3REO0FBQ0EsNkVBQTZFLG1CQUFtQixxQkFBcUIsaUNBQWlDO0FBQ3RKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLHdEQUFVO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDLHdEQUFVO0FBQzFDO0FBQ0Esb0lBQW9JLHVCQUF1QjtBQUMzSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtGQUFrRixFQUFFO0FBQ3BGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNENBQTRDLCtDQUFTO0FBQ3JEO0FBQ0E7QUFDQSxxQ0FBcUMseUNBQXlDO0FBQzlFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxrQ0FBa0M7QUFDOUMsWUFBWSxTQUFTO0FBQ3JCLFlBQVksaUJBQWlCO0FBQzdCO0FBQ0E7QUFDQSw0QkFBNEIsZ0JBQWdCO0FBQzVDO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQSwrQ0FBK0MscUNBQXFDO0FBQ3BGLHdDQUF3Qyw2QkFBNkI7QUFDckU7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLGdCQUFnQjtBQUNsRDtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQSxxREFBcUQsd0RBQXdEO0FBQzdHLHNDQUFzQyw4Q0FBOEM7QUFDcEY7QUFDQSxtREFBbUQsbURBQW1EO0FBQ3RHO0FBQ0E7QUFDQTtBQUNBO0FBQ08sb0NBQW9DLCtDQUFTO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1R0FBdUcsd0JBQXdCLE1BQU0sbUJBQW1CO0FBQ3hKO0FBQ0E7QUFDQSx3R0FBd0cseUJBQXlCLE1BQU0sbUJBQW1CO0FBQzFKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdDQUF3QyxvREFBb0QsK0JBQStCLEVBQUU7QUFDN0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNENBQTRDLCtDQUFTO0FBQ3JEO0FBQ0E7QUFDQSwyQ0FBMkMsUUFBUTtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vbm9kZV9tb2R1bGVzL2xhbmdjaGFpbi9kaXN0L2NoYWlucy9zZXF1ZW50aWFsX2NoYWluLmpzPzVjOWEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQmFzZUNoYWluIH0gZnJvbSBcIi4vYmFzZS5qc1wiO1xuaW1wb3J0IHsgaW50ZXJzZWN0aW9uLCB1bmlvbiwgZGlmZmVyZW5jZSB9IGZyb20gXCIuLi91dGlsL3NldC5qc1wiO1xuZnVuY3Rpb24gZm9ybWF0U2V0KGlucHV0KSB7XG4gICAgcmV0dXJuIEFycmF5LmZyb20oaW5wdXQpXG4gICAgICAgIC5tYXAoKGkpID0+IGBcIiR7aX1cImApXG4gICAgICAgIC5qb2luKFwiLCBcIik7XG59XG4vKipcbiAqIENoYWluIHdoZXJlIHRoZSBvdXRwdXRzIG9mIG9uZSBjaGFpbiBmZWVkIGRpcmVjdGx5IGludG8gbmV4dC5cbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBjb25zdCBwcm9tcHRUZW1wbGF0ZSA9IG5ldyBQcm9tcHRUZW1wbGF0ZSh7XG4gKiAgIHRlbXBsYXRlOiBgWW91IGFyZSBhIHBsYXl3cmlnaHQuIEdpdmVuIHRoZSB0aXRsZSBvZiBwbGF5IGFuZCB0aGUgZXJhIGl0IGlzIHNldCBpbiwgaXQgaXMgeW91ciBqb2IgdG8gd3JpdGUgYSBzeW5vcHNpcyBmb3IgdGhhdCB0aXRsZS5cbiAqIFRpdGxlOiB7dGl0bGV9XG4gKiBFcmE6IHtlcmF9XG4gKiBQbGF5d3JpZ2h0OiBUaGlzIGlzIGEgc3lub3BzaXMgZm9yIHRoZSBhYm92ZSBwbGF5OmAsXG4gKiAgIGlucHV0VmFyaWFibGVzOiBbXCJ0aXRsZVwiLCBcImVyYVwiXSxcbiAqIH0pO1xuXG4gKiBjb25zdCByZXZpZXdQcm9tcHRUZW1wbGF0ZSA9IG5ldyBQcm9tcHRUZW1wbGF0ZSh7XG4gKiAgIHRlbXBsYXRlOiBgWW91IGFyZSBhIHBsYXkgY3JpdGljIGZyb20gdGhlIE5ldyBZb3JrIFRpbWVzLiBHaXZlbiB0aGUgc3lub3BzaXMgb2YgcGxheSwgaXQgaXMgeW91ciBqb2IgdG8gd3JpdGUgYSByZXZpZXcgZm9yIHRoYXQgcGxheS5cbiAqXG4gKiAgICAgUGxheSBTeW5vcHNpczpcbiAqICAgICB7c3lub3BzaXN9XG4gKiAgICAgUmV2aWV3IGZyb20gYSBOZXcgWW9yayBUaW1lcyBwbGF5IGNyaXRpYyBvZiB0aGUgYWJvdmUgcGxheTpgLFxuICogICBpbnB1dFZhcmlhYmxlczogW1wic3lub3BzaXNcIl0sXG4gKiB9KTtcblxuICogY29uc3Qgb3ZlcmFsbENoYWluID0gbmV3IFNlcXVlbnRpYWxDaGFpbih7XG4gKiAgIGNoYWluczogW1xuICogICAgIG5ldyBMTE1DaGFpbih7XG4gKiAgICAgICBsbG06IG5ldyBDaGF0T3BlbkFJKHsgdGVtcGVyYXR1cmU6IDAgfSksXG4gKiAgICAgICBwcm9tcHQ6IHByb21wdFRlbXBsYXRlLFxuICogICAgICAgb3V0cHV0S2V5OiBcInN5bm9wc2lzXCIsXG4gKiAgICAgfSksXG4gKiAgICAgbmV3IExMTUNoYWluKHtcbiAqICAgICAgIGxsbTogbmV3IE9wZW5BSSh7IHRlbXBlcmF0dXJlOiAwIH0pLFxuICogICAgICAgcHJvbXB0OiByZXZpZXdQcm9tcHRUZW1wbGF0ZSxcbiAqICAgICAgIG91dHB1dEtleTogXCJyZXZpZXdcIixcbiAqICAgICB9KSxcbiAqICAgXSxcbiAqICAgaW5wdXRWYXJpYWJsZXM6IFtcImVyYVwiLCBcInRpdGxlXCJdLFxuICogICBvdXRwdXRWYXJpYWJsZXM6IFtcInN5bm9wc2lzXCIsIFwicmV2aWV3XCJdLFxuICogICB2ZXJib3NlOiB0cnVlLFxuICogfSk7XG5cbiAqIGNvbnN0IGNoYWluRXhlY3V0aW9uUmVzdWx0ID0gYXdhaXQgb3ZlcmFsbENoYWluLmNhbGwoe1xuICogICB0aXRsZTogXCJUcmFnZWR5IGF0IHN1bnNldCBvbiB0aGUgYmVhY2hcIixcbiAqICAgZXJhOiBcIlZpY3RvcmlhbiBFbmdsYW5kXCIsXG4gKiB9KTtcbiAqIGNvbnNvbGUubG9nKGNoYWluRXhlY3V0aW9uUmVzdWx0KTtcbiAqIGBgYFxuICpcbiAqIEBkZXByZWNhdGVkXG4gKiBTd2l0Y2ggdG8ge0BsaW5rIGh0dHBzOi8vanMubGFuZ2NoYWluLmNvbS9kb2NzL2V4cHJlc3Npb25fbGFuZ3VhZ2UvIHwgZXhwcmVzc2lvbiBsYW5ndWFnZX0uXG4gKiBXaWxsIGJlIHJlbW92ZWQgaW4gMC4yLjBcbiAqL1xuZXhwb3J0IGNsYXNzIFNlcXVlbnRpYWxDaGFpbiBleHRlbmRzIEJhc2VDaGFpbiB7XG4gICAgc3RhdGljIGxjX25hbWUoKSB7XG4gICAgICAgIHJldHVybiBcIlNlcXVlbnRpYWxDaGFpblwiO1xuICAgIH1cbiAgICBnZXQgaW5wdXRLZXlzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pbnB1dFZhcmlhYmxlcztcbiAgICB9XG4gICAgZ2V0IG91dHB1dEtleXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm91dHB1dFZhcmlhYmxlcztcbiAgICB9XG4gICAgY29uc3RydWN0b3IoZmllbGRzKSB7XG4gICAgICAgIHN1cGVyKGZpZWxkcyk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImNoYWluc1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJpbnB1dFZhcmlhYmxlc1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJvdXRwdXRWYXJpYWJsZXNcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwicmV0dXJuQWxsXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuY2hhaW5zID0gZmllbGRzLmNoYWlucztcbiAgICAgICAgdGhpcy5pbnB1dFZhcmlhYmxlcyA9IGZpZWxkcy5pbnB1dFZhcmlhYmxlcztcbiAgICAgICAgdGhpcy5vdXRwdXRWYXJpYWJsZXMgPSBmaWVsZHMub3V0cHV0VmFyaWFibGVzID8/IFtdO1xuICAgICAgICBpZiAodGhpcy5vdXRwdXRWYXJpYWJsZXMubGVuZ3RoID4gMCAmJiBmaWVsZHMucmV0dXJuQWxsKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJFaXRoZXIgc3BlY2lmeSB2YXJpYWJsZXMgdG8gcmV0dXJuIHVzaW5nIGBvdXRwdXRWYXJpYWJsZXNgIG9yIHVzZSBgcmV0dXJuQWxsYCBwYXJhbS4gQ2Fubm90IGFwcGx5IGJvdGggY29uZGl0aW9ucyBhdCB0aGUgc2FtZSB0aW1lLlwiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJldHVybkFsbCA9IGZpZWxkcy5yZXR1cm5BbGwgPz8gZmFsc2U7XG4gICAgICAgIHRoaXMuX3ZhbGlkYXRlQ2hhaW5zKCk7XG4gICAgfVxuICAgIC8qKiBAaWdub3JlICovXG4gICAgX3ZhbGlkYXRlQ2hhaW5zKCkge1xuICAgICAgICBpZiAodGhpcy5jaGFpbnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJTZXF1ZW50aWFsIGNoYWluIG11c3QgaGF2ZSBhdCBsZWFzdCBvbmUgY2hhaW4uXCIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG1lbW9yeUtleXMgPSB0aGlzLm1lbW9yeT8ubWVtb3J5S2V5cyA/PyBbXTtcbiAgICAgICAgY29uc3QgaW5wdXRLZXlzU2V0ID0gbmV3IFNldCh0aGlzLmlucHV0S2V5cyk7XG4gICAgICAgIGNvbnN0IG1lbW9yeUtleXNTZXQgPSBuZXcgU2V0KG1lbW9yeUtleXMpO1xuICAgICAgICBjb25zdCBrZXlzSW50ZXJzZWN0aW9uID0gaW50ZXJzZWN0aW9uKGlucHV0S2V5c1NldCwgbWVtb3J5S2V5c1NldCk7XG4gICAgICAgIGlmIChrZXlzSW50ZXJzZWN0aW9uLnNpemUgPiAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFRoZSBmb2xsb3dpbmcga2V5czogJHtmb3JtYXRTZXQoa2V5c0ludGVyc2VjdGlvbil9IGFyZSBvdmVybGFwcGluZyBiZXR3ZWVuIG1lbW9yeSBhbmQgaW5wdXQga2V5cyBvZiB0aGUgY2hhaW4gdmFyaWFibGVzLiBUaGlzIGNhbiBsZWFkIHRvIHVuZXhwZWN0ZWQgYmVoYXZpb3VyLiBQbGVhc2UgdXNlIGlucHV0IGFuZCBtZW1vcnkga2V5cyB0aGF0IGRvbid0IG92ZXJsYXAuYCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgYXZhaWxhYmxlS2V5cyA9IHVuaW9uKGlucHV0S2V5c1NldCwgbWVtb3J5S2V5c1NldCk7XG4gICAgICAgIGZvciAoY29uc3QgY2hhaW4gb2YgdGhpcy5jaGFpbnMpIHtcbiAgICAgICAgICAgIGxldCBtaXNzaW5nS2V5cyA9IGRpZmZlcmVuY2UobmV3IFNldChjaGFpbi5pbnB1dEtleXMpLCBhdmFpbGFibGVLZXlzKTtcbiAgICAgICAgICAgIGlmIChjaGFpbi5tZW1vcnkpIHtcbiAgICAgICAgICAgICAgICBtaXNzaW5nS2V5cyA9IGRpZmZlcmVuY2UobWlzc2luZ0tleXMsIG5ldyBTZXQoY2hhaW4ubWVtb3J5Lm1lbW9yeUtleXMpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChtaXNzaW5nS2V5cy5zaXplID4gMCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTWlzc2luZyB2YXJpYWJsZXMgZm9yIGNoYWluIFwiJHtjaGFpbi5fY2hhaW5UeXBlKCl9XCI6ICR7Zm9ybWF0U2V0KG1pc3NpbmdLZXlzKX0uIE9ubHkgZ290IHRoZSBmb2xsb3dpbmcgdmFyaWFibGVzOiAke2Zvcm1hdFNldChhdmFpbGFibGVLZXlzKX0uYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBvdXRwdXRLZXlzU2V0ID0gbmV3IFNldChjaGFpbi5vdXRwdXRLZXlzKTtcbiAgICAgICAgICAgIGNvbnN0IG92ZXJsYXBwaW5nT3V0cHV0S2V5cyA9IGludGVyc2VjdGlvbihhdmFpbGFibGVLZXlzLCBvdXRwdXRLZXlzU2V0KTtcbiAgICAgICAgICAgIGlmIChvdmVybGFwcGluZ091dHB1dEtleXMuc2l6ZSA+IDApIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFRoZSBmb2xsb3dpbmcgb3V0cHV0IHZhcmlhYmxlcyBmb3IgY2hhaW4gXCIke2NoYWluLl9jaGFpblR5cGUoKX1cIiBhcmUgb3ZlcmxhcHBpbmc6ICR7Zm9ybWF0U2V0KG92ZXJsYXBwaW5nT3V0cHV0S2V5cyl9LiBUaGlzIGNhbiBsZWFkIHRvIHVuZXhwZWN0ZWQgYmVoYXZpb3VyLmApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChjb25zdCBvdXRwdXRLZXkgb2Ygb3V0cHV0S2V5c1NldCkge1xuICAgICAgICAgICAgICAgIGF2YWlsYWJsZUtleXMuYWRkKG91dHB1dEtleSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMub3V0cHV0VmFyaWFibGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgaWYgKHRoaXMucmV0dXJuQWxsKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgb3V0cHV0S2V5cyA9IGRpZmZlcmVuY2UoYXZhaWxhYmxlS2V5cywgaW5wdXRLZXlzU2V0KTtcbiAgICAgICAgICAgICAgICB0aGlzLm91dHB1dFZhcmlhYmxlcyA9IEFycmF5LmZyb20ob3V0cHV0S2V5cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLm91dHB1dFZhcmlhYmxlcyA9IHRoaXMuY2hhaW5zW3RoaXMuY2hhaW5zLmxlbmd0aCAtIDFdLm91dHB1dEtleXM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBtaXNzaW5nS2V5cyA9IGRpZmZlcmVuY2UobmV3IFNldCh0aGlzLm91dHB1dFZhcmlhYmxlcyksIG5ldyBTZXQoYXZhaWxhYmxlS2V5cykpO1xuICAgICAgICAgICAgaWYgKG1pc3NpbmdLZXlzLnNpemUgPiAwKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBUaGUgZm9sbG93aW5nIG91dHB1dCB2YXJpYWJsZXMgd2VyZSBleHBlY3RlZCB0byBiZSBpbiB0aGUgZmluYWwgY2hhaW4gb3V0cHV0IGJ1dCB3ZXJlIG5vdCBmb3VuZDogJHtmb3JtYXRTZXQobWlzc2luZ0tleXMpfS5gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKiogQGlnbm9yZSAqL1xuICAgIGFzeW5jIF9jYWxsKHZhbHVlcywgcnVuTWFuYWdlcikge1xuICAgICAgICBsZXQgaW5wdXQgPSB7fTtcbiAgICAgICAgY29uc3QgYWxsQ2hhaW5WYWx1ZXMgPSB2YWx1ZXM7XG4gICAgICAgIGxldCBpID0gMDtcbiAgICAgICAgZm9yIChjb25zdCBjaGFpbiBvZiB0aGlzLmNoYWlucykge1xuICAgICAgICAgICAgaSArPSAxO1xuICAgICAgICAgICAgaW5wdXQgPSBhd2FpdCBjaGFpbi5jYWxsKGFsbENoYWluVmFsdWVzLCBydW5NYW5hZ2VyPy5nZXRDaGlsZChgc3RlcF8ke2l9YCkpO1xuICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgb2YgT2JqZWN0LmtleXMoaW5wdXQpKSB7XG4gICAgICAgICAgICAgICAgYWxsQ2hhaW5WYWx1ZXNba2V5XSA9IGlucHV0W2tleV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgb3V0cHV0ID0ge307XG4gICAgICAgIGZvciAoY29uc3Qga2V5IG9mIHRoaXMub3V0cHV0VmFyaWFibGVzKSB7XG4gICAgICAgICAgICBvdXRwdXRba2V5XSA9IGFsbENoYWluVmFsdWVzW2tleV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICB9XG4gICAgX2NoYWluVHlwZSgpIHtcbiAgICAgICAgcmV0dXJuIFwic2VxdWVudGlhbF9jaGFpblwiO1xuICAgIH1cbiAgICBzdGF0aWMgYXN5bmMgZGVzZXJpYWxpemUoZGF0YSkge1xuICAgICAgICBjb25zdCBjaGFpbnMgPSBbXTtcbiAgICAgICAgY29uc3QgaW5wdXRWYXJpYWJsZXMgPSBkYXRhLmlucHV0X3ZhcmlhYmxlcztcbiAgICAgICAgY29uc3Qgb3V0cHV0VmFyaWFibGVzID0gZGF0YS5vdXRwdXRfdmFyaWFibGVzO1xuICAgICAgICBjb25zdCBzZXJpYWxpemVkQ2hhaW5zID0gZGF0YS5jaGFpbnM7XG4gICAgICAgIGZvciAoY29uc3Qgc2VyaWFsaXplZENoYWluIG9mIHNlcmlhbGl6ZWRDaGFpbnMpIHtcbiAgICAgICAgICAgIGNvbnN0IGRlc2VyaWFsaXplZENoYWluID0gYXdhaXQgQmFzZUNoYWluLmRlc2VyaWFsaXplKHNlcmlhbGl6ZWRDaGFpbik7XG4gICAgICAgICAgICBjaGFpbnMucHVzaChkZXNlcmlhbGl6ZWRDaGFpbik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBTZXF1ZW50aWFsQ2hhaW4oeyBjaGFpbnMsIGlucHV0VmFyaWFibGVzLCBvdXRwdXRWYXJpYWJsZXMgfSk7XG4gICAgfVxuICAgIHNlcmlhbGl6ZSgpIHtcbiAgICAgICAgY29uc3QgY2hhaW5zID0gW107XG4gICAgICAgIGZvciAoY29uc3QgY2hhaW4gb2YgdGhpcy5jaGFpbnMpIHtcbiAgICAgICAgICAgIGNoYWlucy5wdXNoKGNoYWluLnNlcmlhbGl6ZSgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgX3R5cGU6IHRoaXMuX2NoYWluVHlwZSgpLFxuICAgICAgICAgICAgaW5wdXRfdmFyaWFibGVzOiB0aGlzLmlucHV0VmFyaWFibGVzLFxuICAgICAgICAgICAgb3V0cHV0X3ZhcmlhYmxlczogdGhpcy5vdXRwdXRWYXJpYWJsZXMsXG4gICAgICAgICAgICBjaGFpbnMsXG4gICAgICAgIH07XG4gICAgfVxufVxuLyoqXG4gKiBAZGVwcmVjYXRlZCBTd2l0Y2ggdG8gZXhwcmVzc2lvbiBsYW5ndWFnZTogaHR0cHM6Ly9qcy5sYW5nY2hhaW4uY29tL2RvY3MvZXhwcmVzc2lvbl9sYW5ndWFnZS9cbiAqIFNpbXBsZSBjaGFpbiB3aGVyZSBhIHNpbmdsZSBzdHJpbmcgb3V0cHV0IG9mIG9uZSBjaGFpbiBpcyBmZWQgZGlyZWN0bHkgaW50byB0aGUgbmV4dC5cbiAqIEBhdWdtZW50cyBCYXNlQ2hhaW5cbiAqIEBhdWdtZW50cyBTaW1wbGVTZXF1ZW50aWFsQ2hhaW5JbnB1dFxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogaW1wb3J0IHsgU2ltcGxlU2VxdWVudGlhbENoYWluLCBMTE1DaGFpbiB9IGZyb20gXCJsYW5nY2hhaW4vY2hhaW5zXCI7XG4gKiBpbXBvcnQgeyBPcGVuQUkgfSBmcm9tIFwibGFuZ2NoYWluL2xsbXMvb3BlbmFpXCI7XG4gKiBpbXBvcnQgeyBQcm9tcHRUZW1wbGF0ZSB9IGZyb20gXCJsYW5nY2hhaW4vcHJvbXB0c1wiO1xuICpcbiAqIC8vIFRoaXMgaXMgYW4gTExNQ2hhaW4gdG8gd3JpdGUgYSBzeW5vcHNpcyBnaXZlbiBhIHRpdGxlIG9mIGEgcGxheS5cbiAqIGNvbnN0IGxsbSA9IG5ldyBPcGVuQUkoeyB0ZW1wZXJhdHVyZTogMCB9KTtcbiAqIGNvbnN0IHRlbXBsYXRlID0gYFlvdSBhcmUgYSBwbGF5d3JpZ2h0LiBHaXZlbiB0aGUgdGl0bGUgb2YgcGxheSwgaXQgaXMgeW91ciBqb2IgdG8gd3JpdGUgYSBzeW5vcHNpcyBmb3IgdGhhdCB0aXRsZS5cbiAqXG4gKiBUaXRsZToge3RpdGxlfVxuICogUGxheXdyaWdodDogVGhpcyBpcyBhIHN5bm9wc2lzIGZvciB0aGUgYWJvdmUgcGxheTpgXG4gKiBjb25zdCBwcm9tcHRUZW1wbGF0ZSA9IG5ldyBQcm9tcHRUZW1wbGF0ZSh7IHRlbXBsYXRlLCBpbnB1dFZhcmlhYmxlczogW1widGl0bGVcIl0gfSk7XG4gKiBjb25zdCBzeW5vcHNpc0NoYWluID0gbmV3IExMTUNoYWluKHsgbGxtLCBwcm9tcHQ6IHByb21wdFRlbXBsYXRlIH0pO1xuICpcbiAqXG4gKiAvLyBUaGlzIGlzIGFuIExMTUNoYWluIHRvIHdyaXRlIGEgcmV2aWV3IG9mIGEgcGxheSBnaXZlbiBhIHN5bm9wc2lzLlxuICogY29uc3QgcmV2aWV3TExNID0gbmV3IE9wZW5BSSh7IHRlbXBlcmF0dXJlOiAwIH0pXG4gKiBjb25zdCByZXZpZXdUZW1wbGF0ZSA9IGBZb3UgYXJlIGEgcGxheSBjcml0aWMgZnJvbSB0aGUgTmV3IFlvcmsgVGltZXMuIEdpdmVuIHRoZSBzeW5vcHNpcyBvZiBwbGF5LCBpdCBpcyB5b3VyIGpvYiB0byB3cml0ZSBhIHJldmlldyBmb3IgdGhhdCBwbGF5LlxuICpcbiAqIFBsYXkgU3lub3BzaXM6XG4gKiB7c3lub3BzaXN9XG4gKiBSZXZpZXcgZnJvbSBhIE5ldyBZb3JrIFRpbWVzIHBsYXkgY3JpdGljIG9mIHRoZSBhYm92ZSBwbGF5OmBcbiAqIGNvbnN0IHJldmlld1Byb21wdFRlbXBsYXRlID0gbmV3IFByb21wdFRlbXBsYXRlKHsgdGVtcGxhdGU6IHJldmlld1RlbXBsYXRlLCBpbnB1dFZhcmlhYmxlczogW1wic3lub3BzaXNcIl0gfSk7XG4gKiBjb25zdCByZXZpZXdDaGFpbiA9IG5ldyBMTE1DaGFpbih7IGxsbTogcmV2aWV3TExNLCBwcm9tcHQ6IHJldmlld1Byb21wdFRlbXBsYXRlIH0pO1xuICpcbiAqIGNvbnN0IG92ZXJhbGxDaGFpbiA9IG5ldyBTaW1wbGVTZXF1ZW50aWFsQ2hhaW4oe2NoYWluczogW3N5bm9wc2lzQ2hhaW4sIHJldmlld0NoYWluXSwgdmVyYm9zZTp0cnVlfSlcbiAqIGNvbnN0IHJldmlldyA9IGF3YWl0IG92ZXJhbGxDaGFpbi5ydW4oXCJUcmFnZWR5IGF0IHN1bnNldCBvbiB0aGUgYmVhY2hcIilcbiAqIC8vIHRoZSB2YXJpYWJsZSByZXZpZXcgY29udGFpbnMgcmVzdWx0aW5nIHBsYXkgcmV2aWV3LlxuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBTaW1wbGVTZXF1ZW50aWFsQ2hhaW4gZXh0ZW5kcyBCYXNlQ2hhaW4ge1xuICAgIHN0YXRpYyBsY19uYW1lKCkge1xuICAgICAgICByZXR1cm4gXCJTaW1wbGVTZXF1ZW50aWFsQ2hhaW5cIjtcbiAgICB9XG4gICAgZ2V0IGlucHV0S2V5cygpIHtcbiAgICAgICAgcmV0dXJuIFt0aGlzLmlucHV0S2V5XTtcbiAgICB9XG4gICAgZ2V0IG91dHB1dEtleXMoKSB7XG4gICAgICAgIHJldHVybiBbdGhpcy5vdXRwdXRLZXldO1xuICAgIH1cbiAgICBjb25zdHJ1Y3RvcihmaWVsZHMpIHtcbiAgICAgICAgc3VwZXIoZmllbGRzKTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiY2hhaW5zXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImlucHV0S2V5XCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBcImlucHV0XCJcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm91dHB1dEtleVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogXCJvdXRwdXRcIlxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwidHJpbU91dHB1dHNcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5jaGFpbnMgPSBmaWVsZHMuY2hhaW5zO1xuICAgICAgICB0aGlzLnRyaW1PdXRwdXRzID0gZmllbGRzLnRyaW1PdXRwdXRzID8/IGZhbHNlO1xuICAgICAgICB0aGlzLl92YWxpZGF0ZUNoYWlucygpO1xuICAgIH1cbiAgICAvKiogQGlnbm9yZSAqL1xuICAgIF92YWxpZGF0ZUNoYWlucygpIHtcbiAgICAgICAgZm9yIChjb25zdCBjaGFpbiBvZiB0aGlzLmNoYWlucykge1xuICAgICAgICAgICAgaWYgKGNoYWluLmlucHV0S2V5cy5maWx0ZXIoKGspID0+ICFjaGFpbi5tZW1vcnk/Lm1lbW9yeUtleXMuaW5jbHVkZXMoaykgPz8gdHJ1ZSkubGVuZ3RoICE9PSAxKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDaGFpbnMgdXNlZCBpbiBTaW1wbGVTZXF1ZW50aWFsQ2hhaW4gc2hvdWxkIGFsbCBoYXZlIG9uZSBpbnB1dCwgZ290ICR7Y2hhaW4uaW5wdXRLZXlzLmxlbmd0aH0gZm9yICR7Y2hhaW4uX2NoYWluVHlwZSgpfS5gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjaGFpbi5vdXRwdXRLZXlzLmxlbmd0aCAhPT0gMSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQ2hhaW5zIHVzZWQgaW4gU2ltcGxlU2VxdWVudGlhbENoYWluIHNob3VsZCBhbGwgaGF2ZSBvbmUgb3V0cHV0LCBnb3QgJHtjaGFpbi5vdXRwdXRLZXlzLmxlbmd0aH0gZm9yICR7Y2hhaW4uX2NoYWluVHlwZSgpfS5gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKiogQGlnbm9yZSAqL1xuICAgIGFzeW5jIF9jYWxsKHZhbHVlcywgcnVuTWFuYWdlcikge1xuICAgICAgICBsZXQgaW5wdXQgPSB2YWx1ZXNbdGhpcy5pbnB1dEtleV07XG4gICAgICAgIGxldCBpID0gMDtcbiAgICAgICAgZm9yIChjb25zdCBjaGFpbiBvZiB0aGlzLmNoYWlucykge1xuICAgICAgICAgICAgaSArPSAxO1xuICAgICAgICAgICAgaW5wdXQgPSAoYXdhaXQgY2hhaW4uY2FsbCh7IFtjaGFpbi5pbnB1dEtleXNbMF1dOiBpbnB1dCwgc2lnbmFsOiB2YWx1ZXMuc2lnbmFsIH0sIHJ1bk1hbmFnZXI/LmdldENoaWxkKGBzdGVwXyR7aX1gKSkpW2NoYWluLm91dHB1dEtleXNbMF1dO1xuICAgICAgICAgICAgaWYgKHRoaXMudHJpbU91dHB1dHMpIHtcbiAgICAgICAgICAgICAgICBpbnB1dCA9IGlucHV0LnRyaW0oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGF3YWl0IHJ1bk1hbmFnZXI/LmhhbmRsZVRleHQoaW5wdXQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IFt0aGlzLm91dHB1dEtleV06IGlucHV0IH07XG4gICAgfVxuICAgIF9jaGFpblR5cGUoKSB7XG4gICAgICAgIHJldHVybiBcInNpbXBsZV9zZXF1ZW50aWFsX2NoYWluXCI7XG4gICAgfVxuICAgIHN0YXRpYyBhc3luYyBkZXNlcmlhbGl6ZShkYXRhKSB7XG4gICAgICAgIGNvbnN0IGNoYWlucyA9IFtdO1xuICAgICAgICBjb25zdCBzZXJpYWxpemVkQ2hhaW5zID0gZGF0YS5jaGFpbnM7XG4gICAgICAgIGZvciAoY29uc3Qgc2VyaWFsaXplZENoYWluIG9mIHNlcmlhbGl6ZWRDaGFpbnMpIHtcbiAgICAgICAgICAgIGNvbnN0IGRlc2VyaWFsaXplZENoYWluID0gYXdhaXQgQmFzZUNoYWluLmRlc2VyaWFsaXplKHNlcmlhbGl6ZWRDaGFpbik7XG4gICAgICAgICAgICBjaGFpbnMucHVzaChkZXNlcmlhbGl6ZWRDaGFpbik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBTaW1wbGVTZXF1ZW50aWFsQ2hhaW4oeyBjaGFpbnMgfSk7XG4gICAgfVxuICAgIHNlcmlhbGl6ZSgpIHtcbiAgICAgICAgY29uc3QgY2hhaW5zID0gW107XG4gICAgICAgIGZvciAoY29uc3QgY2hhaW4gb2YgdGhpcy5jaGFpbnMpIHtcbiAgICAgICAgICAgIGNoYWlucy5wdXNoKGNoYWluLnNlcmlhbGl6ZSgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgX3R5cGU6IHRoaXMuX2NoYWluVHlwZSgpLFxuICAgICAgICAgICAgY2hhaW5zLFxuICAgICAgICB9O1xuICAgIH1cbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/langchain/dist/chains/sequential_chain.js\n"));

/***/ }),

/***/ "(app-pages-browser)/./node_modules/langchain/dist/util/set.js":
/*!*************************************************!*\
  !*** ./node_modules/langchain/dist/util/set.js ***!
  \*************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   difference: function() { return /* binding */ difference; },\n/* harmony export */   intersection: function() { return /* binding */ intersection; },\n/* harmony export */   union: function() { return /* binding */ union; }\n/* harmony export */ });\n/**\n * Source: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set#implementing_basic_set_operations\n */\n/**\n * returns intersection of two sets\n */\nfunction intersection(setA, setB) {\n    const _intersection = new Set();\n    for (const elem of setB) {\n        if (setA.has(elem)) {\n            _intersection.add(elem);\n        }\n    }\n    return _intersection;\n}\n/**\n * returns union of two sets\n */\nfunction union(setA, setB) {\n    const _union = new Set(setA);\n    for (const elem of setB) {\n        _union.add(elem);\n    }\n    return _union;\n}\n/**\n * returns difference of two sets\n */\nfunction difference(setA, setB) {\n    const _difference = new Set(setA);\n    for (const elem of setB) {\n        _difference.delete(elem);\n    }\n    return _difference;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC91dGlsL3NldC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL25vZGVfbW9kdWxlcy9sYW5nY2hhaW4vZGlzdC91dGlsL3NldC5qcz8xNzViIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogU291cmNlOiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9TZXQjaW1wbGVtZW50aW5nX2Jhc2ljX3NldF9vcGVyYXRpb25zXG4gKi9cbi8qKlxuICogcmV0dXJucyBpbnRlcnNlY3Rpb24gb2YgdHdvIHNldHNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGludGVyc2VjdGlvbihzZXRBLCBzZXRCKSB7XG4gICAgY29uc3QgX2ludGVyc2VjdGlvbiA9IG5ldyBTZXQoKTtcbiAgICBmb3IgKGNvbnN0IGVsZW0gb2Ygc2V0Qikge1xuICAgICAgICBpZiAoc2V0QS5oYXMoZWxlbSkpIHtcbiAgICAgICAgICAgIF9pbnRlcnNlY3Rpb24uYWRkKGVsZW0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBfaW50ZXJzZWN0aW9uO1xufVxuLyoqXG4gKiByZXR1cm5zIHVuaW9uIG9mIHR3byBzZXRzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1bmlvbihzZXRBLCBzZXRCKSB7XG4gICAgY29uc3QgX3VuaW9uID0gbmV3IFNldChzZXRBKTtcbiAgICBmb3IgKGNvbnN0IGVsZW0gb2Ygc2V0Qikge1xuICAgICAgICBfdW5pb24uYWRkKGVsZW0pO1xuICAgIH1cbiAgICByZXR1cm4gX3VuaW9uO1xufVxuLyoqXG4gKiByZXR1cm5zIGRpZmZlcmVuY2Ugb2YgdHdvIHNldHNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRpZmZlcmVuY2Uoc2V0QSwgc2V0Qikge1xuICAgIGNvbnN0IF9kaWZmZXJlbmNlID0gbmV3IFNldChzZXRBKTtcbiAgICBmb3IgKGNvbnN0IGVsZW0gb2Ygc2V0Qikge1xuICAgICAgICBfZGlmZmVyZW5jZS5kZWxldGUoZWxlbSk7XG4gICAgfVxuICAgIHJldHVybiBfZGlmZmVyZW5jZTtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/langchain/dist/util/set.js\n"));

/***/ })

}]);