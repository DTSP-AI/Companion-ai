"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/companion/[companionId]/history/route";
exports.ids = ["app/api/companion/[companionId]/history/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "@prisma/client/scripts/default-index.js":
/*!**********************************************************!*\
  !*** external "@prisma/client/scripts/default-index.js" ***!
  \**********************************************************/
/***/ ((module) => {

module.exports = require("@prisma/client/scripts/default-index.js");

/***/ }),

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "async_hooks":
/*!******************************!*\
  !*** external "async_hooks" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("async_hooks");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:crypto");

/***/ }),

/***/ "node:fs":
/*!**************************!*\
  !*** external "node:fs" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("node:fs");

/***/ }),

/***/ "node:fs/promises":
/*!***********************************!*\
  !*** external "node:fs/promises" ***!
  \***********************************/
/***/ ((module) => {

module.exports = require("node:fs/promises");

/***/ }),

/***/ "node:https":
/*!*****************************!*\
  !*** external "node:https" ***!
  \*****************************/
/***/ ((module) => {

module.exports = require("node:https");

/***/ }),

/***/ "node:path":
/*!****************************!*\
  !*** external "node:path" ***!
  \****************************/
/***/ ((module) => {

module.exports = require("node:path");

/***/ }),

/***/ "node:stream":
/*!******************************!*\
  !*** external "node:stream" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:stream");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "worker_threads":
/*!*********************************!*\
  !*** external "worker_threads" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("worker_threads");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcompanion%2F%5BcompanionId%5D%2Fhistory%2Froute&page=%2Fapi%2Fcompanion%2F%5BcompanionId%5D%2Fhistory%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcompanion%2F%5BcompanionId%5D%2Fhistory%2Froute.ts&appDir=C%3A%5CAI_src%5CCompanion_UI%5CSaaS-AI-Companion%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CAI_src%5CCompanion_UI%5CSaaS-AI-Companion&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcompanion%2F%5BcompanionId%5D%2Fhistory%2Froute&page=%2Fapi%2Fcompanion%2F%5BcompanionId%5D%2Fhistory%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcompanion%2F%5BcompanionId%5D%2Fhistory%2Froute.ts&appDir=C%3A%5CAI_src%5CCompanion_UI%5CSaaS-AI-Companion%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CAI_src%5CCompanion_UI%5CSaaS-AI-Companion&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_AI_src_Companion_UI_SaaS_AI_Companion_src_app_api_companion_companionId_history_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/companion/[companionId]/history/route.ts */ \"(rsc)/./src/app/api/companion/[companionId]/history/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/companion/[companionId]/history/route\",\n        pathname: \"/api/companion/[companionId]/history\",\n        filename: \"route\",\n        bundlePath: \"app/api/companion/[companionId]/history/route\"\n    },\n    resolvedPagePath: \"C:\\\\AI_src\\\\Companion_UI\\\\SaaS-AI-Companion\\\\src\\\\app\\\\api\\\\companion\\\\[companionId]\\\\history\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_AI_src_Companion_UI_SaaS_AI_Companion_src_app_api_companion_companionId_history_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/companion/[companionId]/history/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZjb21wYW5pb24lMkYlNUJjb21wYW5pb25JZCU1RCUyRmhpc3RvcnklMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmNvbXBhbmlvbiUyRiU1QmNvbXBhbmlvbklkJTVEJTJGaGlzdG9yeSUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmNvbXBhbmlvbiUyRiU1QmNvbXBhbmlvbklkJTVEJTJGaGlzdG9yeSUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDQUlfc3JjJTVDQ29tcGFuaW9uX1VJJTVDU2FhUy1BSS1Db21wYW5pb24lNUNzcmMlNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUMlM0ElNUNBSV9zcmMlNUNDb21wYW5pb25fVUklNUNTYWFTLUFJLUNvbXBhbmlvbiZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDdUQ7QUFDcEk7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9haS1jb21wYW5pb24vPzFkNDEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiQzpcXFxcQUlfc3JjXFxcXENvbXBhbmlvbl9VSVxcXFxTYWFTLUFJLUNvbXBhbmlvblxcXFxzcmNcXFxcYXBwXFxcXGFwaVxcXFxjb21wYW5pb25cXFxcW2NvbXBhbmlvbklkXVxcXFxoaXN0b3J5XFxcXHJvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9jb21wYW5pb24vW2NvbXBhbmlvbklkXS9oaXN0b3J5L3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvY29tcGFuaW9uL1tjb21wYW5pb25JZF0vaGlzdG9yeVwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvY29tcGFuaW9uL1tjb21wYW5pb25JZF0vaGlzdG9yeS9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIkM6XFxcXEFJX3NyY1xcXFxDb21wYW5pb25fVUlcXFxcU2FhUy1BSS1Db21wYW5pb25cXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcY29tcGFuaW9uXFxcXFtjb21wYW5pb25JZF1cXFxcaGlzdG9yeVxcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvY29tcGFuaW9uL1tjb21wYW5pb25JZF0vaGlzdG9yeS9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcompanion%2F%5BcompanionId%5D%2Fhistory%2Froute&page=%2Fapi%2Fcompanion%2F%5BcompanionId%5D%2Fhistory%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcompanion%2F%5BcompanionId%5D%2Fhistory%2Froute.ts&appDir=C%3A%5CAI_src%5CCompanion_UI%5CSaaS-AI-Companion%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CAI_src%5CCompanion_UI%5CSaaS-AI-Companion&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/companion/[companionId]/history/route.ts":
/*!**************************************************************!*\
  !*** ./src/app/api/companion/[companionId]/history/route.ts ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DELETE: () => (/* binding */ DELETE)\n/* harmony export */ });\n/* harmony import */ var _lib_memory__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/memory */ \"(rsc)/./src/lib/memory.ts\");\n/* harmony import */ var _lib_prismadb__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/prismadb */ \"(rsc)/./src/lib/prismadb.ts\");\n/* harmony import */ var _clerk_nextjs_server__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @clerk/nextjs/server */ \"(rsc)/./node_modules/@clerk/nextjs/dist/esm/app-router/server/currentUser.js\");\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _langchain_openai__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @langchain/openai */ \"(rsc)/./node_modules/@langchain/openai/index.js\");\n// C:\\AI_src\\Companion_UI\\SaaS-AI-Companion\\src\\app\\api\\companion\\[companionId]\\history\\route.ts\n\n\n\n\n // Import LLM\nasync function DELETE(req, { params }) {\n    try {\n        console.log(\"[DELETE] Clearing companion message history started...\");\n        // Fetching current user\n        const user = await (0,_clerk_nextjs_server__WEBPACK_IMPORTED_MODULE_4__.currentUser)();\n        console.log(\"[DELETE] Current user:\", user?.id);\n        // Validate companionId\n        if (!params.companionId) {\n            console.error(\"[DELETE] Companion ID is required but not provided.\");\n            return new next_server__WEBPACK_IMPORTED_MODULE_2__.NextResponse(\"Companion ID is required\", {\n                status: 400\n            });\n        }\n        console.log(\"[DELETE] Companion ID:\", params.companionId);\n        // Validate user\n        if (!user || !user.id) {\n            console.error(\"[DELETE] Unauthorized request: No user or user ID.\");\n            return new next_server__WEBPACK_IMPORTED_MODULE_2__.NextResponse(\"Unauthorized\", {\n                status: 401\n            });\n        }\n        // Logging LLM initialization\n        console.log(\"[DELETE] Initializing LLM...\");\n        const llm = new _langchain_openai__WEBPACK_IMPORTED_MODULE_3__.ChatOpenAI({\n            modelName: \"gpt-4o-mini\",\n            temperature: 0.9,\n            openAIApiKey: \"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\"\n        });\n        console.log(\"[DELETE] LLM initialized with model:\", llm.modelName);\n        // Logging MemoryManager initialization\n        console.log(\"[DELETE] Getting MemoryManager instance...\");\n        const memoryManager = await _lib_memory__WEBPACK_IMPORTED_MODULE_0__.MemoryManager.getInstance(llm);\n        console.log(\"[DELETE] MemoryManager instance obtained.\");\n        // Create companionKey and log it\n        const companionKey = {\n            companionName: params.companionId,\n            userId: user.id,\n            modelName: \"gpt-4o-mini\"\n        };\n        console.log(\"[DELETE] Companion Key created:\", companionKey);\n        // Logging memory clearing process\n        console.log(\"[DELETE] Clearing memory history for companion:\", companionKey.companionName);\n        await memoryManager.clearHistory(companionKey);\n        console.log(\"[DELETE] Memory history cleared successfully.\");\n        // Logging Prisma deletion process\n        console.log(\"[DELETE] Deleting messages from Prisma for companionId:\", params.companionId);\n        await _lib_prismadb__WEBPACK_IMPORTED_MODULE_1__[\"default\"].message.deleteMany({\n            where: {\n                companionId: params.companionId,\n                userId: user.id\n            }\n        });\n        console.log(\"[DELETE] Messages deleted from Prisma successfully.\");\n        return next_server__WEBPACK_IMPORTED_MODULE_2__.NextResponse.json({\n            message: \"Message history cleared successfully\"\n        });\n    } catch (error) {\n        console.error(\"[COMPANION_HISTORY_DELETE_ERROR]\", error);\n        return new next_server__WEBPACK_IMPORTED_MODULE_2__.NextResponse(\"Internal error\", {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9jb21wYW5pb24vW2NvbXBhbmlvbklkXS9oaXN0b3J5L3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBLGdHQUFnRztBQUVuRDtBQUNQO0FBQ2E7QUFDUjtBQUNJLENBQUMsYUFBYTtBQUV0RCxlQUFlSyxPQUNwQkMsR0FBWSxFQUNaLEVBQUVDLE1BQU0sRUFBdUM7SUFFL0MsSUFBSTtRQUNGQyxRQUFRQyxHQUFHLENBQUM7UUFFWix3QkFBd0I7UUFDeEIsTUFBTUMsT0FBTyxNQUFNUixpRUFBV0E7UUFDOUJNLFFBQVFDLEdBQUcsQ0FBQywwQkFBMEJDLE1BQU1DO1FBRTVDLHVCQUF1QjtRQUN2QixJQUFJLENBQUNKLE9BQU9LLFdBQVcsRUFBRTtZQUN2QkosUUFBUUssS0FBSyxDQUFDO1lBQ2QsT0FBTyxJQUFJVixxREFBWUEsQ0FBQyw0QkFBNEI7Z0JBQUVXLFFBQVE7WUFBSTtRQUNwRTtRQUNBTixRQUFRQyxHQUFHLENBQUMsMEJBQTBCRixPQUFPSyxXQUFXO1FBRXhELGdCQUFnQjtRQUNoQixJQUFJLENBQUNGLFFBQVEsQ0FBQ0EsS0FBS0MsRUFBRSxFQUFFO1lBQ3JCSCxRQUFRSyxLQUFLLENBQUM7WUFDZCxPQUFPLElBQUlWLHFEQUFZQSxDQUFDLGdCQUFnQjtnQkFBRVcsUUFBUTtZQUFJO1FBQ3hEO1FBRUEsNkJBQTZCO1FBQzdCTixRQUFRQyxHQUFHLENBQUM7UUFDWixNQUFNTSxNQUFNLElBQUlYLHlEQUFVQSxDQUFDO1lBQ3pCWSxXQUFXO1lBQ1hDLGFBQWE7WUFDYkMsY0FBY0MscURBQXNDO1FBQ3REO1FBQ0FYLFFBQVFDLEdBQUcsQ0FBQyx3Q0FBd0NNLElBQUlDLFNBQVM7UUFFakUsdUNBQXVDO1FBQ3ZDUixRQUFRQyxHQUFHLENBQUM7UUFDWixNQUFNYSxnQkFBZ0IsTUFBTXRCLHNEQUFhQSxDQUFDdUIsV0FBVyxDQUFDUjtRQUN0RFAsUUFBUUMsR0FBRyxDQUFDO1FBRVosaUNBQWlDO1FBQ2pDLE1BQU1lLGVBQWU7WUFDbkJDLGVBQWVsQixPQUFPSyxXQUFXO1lBQ2pDYyxRQUFRaEIsS0FBS0MsRUFBRTtZQUNmSyxXQUFXO1FBQ2I7UUFDQVIsUUFBUUMsR0FBRyxDQUFDLG1DQUFtQ2U7UUFFL0Msa0NBQWtDO1FBQ2xDaEIsUUFBUUMsR0FBRyxDQUFDLG1EQUFtRGUsYUFBYUMsYUFBYTtRQUN6RixNQUFNSCxjQUFjSyxZQUFZLENBQUNIO1FBQ2pDaEIsUUFBUUMsR0FBRyxDQUFDO1FBRVosa0NBQWtDO1FBQ2xDRCxRQUFRQyxHQUFHLENBQUMsMkRBQTJERixPQUFPSyxXQUFXO1FBQ3pGLE1BQU1YLHFEQUFRQSxDQUFDMkIsT0FBTyxDQUFDQyxVQUFVLENBQUM7WUFDaENDLE9BQU87Z0JBQ0xsQixhQUFhTCxPQUFPSyxXQUFXO2dCQUMvQmMsUUFBUWhCLEtBQUtDLEVBQUU7WUFDakI7UUFDRjtRQUNBSCxRQUFRQyxHQUFHLENBQUM7UUFFWixPQUFPTixxREFBWUEsQ0FBQzRCLElBQUksQ0FBQztZQUFFSCxTQUFTO1FBQXVDO0lBRTdFLEVBQUUsT0FBT2YsT0FBTztRQUNkTCxRQUFRSyxLQUFLLENBQUMsb0NBQW9DQTtRQUNsRCxPQUFPLElBQUlWLHFEQUFZQSxDQUFDLGtCQUFrQjtZQUFFVyxRQUFRO1FBQUk7SUFDMUQ7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2FpLWNvbXBhbmlvbi8uL3NyYy9hcHAvYXBpL2NvbXBhbmlvbi9bY29tcGFuaW9uSWRdL2hpc3Rvcnkvcm91dGUudHM/NmNkMCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDOlxcQUlfc3JjXFxDb21wYW5pb25fVUlcXFNhYVMtQUktQ29tcGFuaW9uXFxzcmNcXGFwcFxcYXBpXFxjb21wYW5pb25cXFtjb21wYW5pb25JZF1cXGhpc3RvcnlcXHJvdXRlLnRzXHJcblxyXG5pbXBvcnQgeyBNZW1vcnlNYW5hZ2VyIH0gZnJvbSBcIkAvbGliL21lbW9yeVwiO1xyXG5pbXBvcnQgcHJpc21hZGIgZnJvbSBcIkAvbGliL3ByaXNtYWRiXCI7XHJcbmltcG9ydCB7IGN1cnJlbnRVc2VyIH0gZnJvbSBcIkBjbGVyay9uZXh0anMvc2VydmVyXCI7XHJcbmltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gXCJuZXh0L3NlcnZlclwiO1xyXG5pbXBvcnQgeyBDaGF0T3BlbkFJIH0gZnJvbSBcIkBsYW5nY2hhaW4vb3BlbmFpXCI7IC8vIEltcG9ydCBMTE1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBERUxFVEUoXHJcbiAgcmVxOiBSZXF1ZXN0LFxyXG4gIHsgcGFyYW1zIH06IHsgcGFyYW1zOiB7IGNvbXBhbmlvbklkOiBzdHJpbmcgfSB9LFxyXG4pIHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coXCJbREVMRVRFXSBDbGVhcmluZyBjb21wYW5pb24gbWVzc2FnZSBoaXN0b3J5IHN0YXJ0ZWQuLi5cIik7XHJcblxyXG4gICAgLy8gRmV0Y2hpbmcgY3VycmVudCB1c2VyXHJcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgY3VycmVudFVzZXIoKTtcclxuICAgIGNvbnNvbGUubG9nKFwiW0RFTEVURV0gQ3VycmVudCB1c2VyOlwiLCB1c2VyPy5pZCk7XHJcblxyXG4gICAgLy8gVmFsaWRhdGUgY29tcGFuaW9uSWRcclxuICAgIGlmICghcGFyYW1zLmNvbXBhbmlvbklkKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJbREVMRVRFXSBDb21wYW5pb24gSUQgaXMgcmVxdWlyZWQgYnV0IG5vdCBwcm92aWRlZC5cIik7XHJcbiAgICAgIHJldHVybiBuZXcgTmV4dFJlc3BvbnNlKFwiQ29tcGFuaW9uIElEIGlzIHJlcXVpcmVkXCIsIHsgc3RhdHVzOiA0MDAgfSk7XHJcbiAgICB9XHJcbiAgICBjb25zb2xlLmxvZyhcIltERUxFVEVdIENvbXBhbmlvbiBJRDpcIiwgcGFyYW1zLmNvbXBhbmlvbklkKTtcclxuXHJcbiAgICAvLyBWYWxpZGF0ZSB1c2VyXHJcbiAgICBpZiAoIXVzZXIgfHwgIXVzZXIuaWQpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIltERUxFVEVdIFVuYXV0aG9yaXplZCByZXF1ZXN0OiBObyB1c2VyIG9yIHVzZXIgSUQuXCIpO1xyXG4gICAgICByZXR1cm4gbmV3IE5leHRSZXNwb25zZShcIlVuYXV0aG9yaXplZFwiLCB7IHN0YXR1czogNDAxIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIExvZ2dpbmcgTExNIGluaXRpYWxpemF0aW9uXHJcbiAgICBjb25zb2xlLmxvZyhcIltERUxFVEVdIEluaXRpYWxpemluZyBMTE0uLi5cIik7XHJcbiAgICBjb25zdCBsbG0gPSBuZXcgQ2hhdE9wZW5BSSh7XHJcbiAgICAgIG1vZGVsTmFtZTogXCJncHQtNG8tbWluaVwiLFxyXG4gICAgICB0ZW1wZXJhdHVyZTogMC45LFxyXG4gICAgICBvcGVuQUlBcGlLZXk6IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX09QRU5BSV9BUElfS0VZLFxyXG4gICAgfSk7XHJcbiAgICBjb25zb2xlLmxvZyhcIltERUxFVEVdIExMTSBpbml0aWFsaXplZCB3aXRoIG1vZGVsOlwiLCBsbG0ubW9kZWxOYW1lKTtcclxuXHJcbiAgICAvLyBMb2dnaW5nIE1lbW9yeU1hbmFnZXIgaW5pdGlhbGl6YXRpb25cclxuICAgIGNvbnNvbGUubG9nKFwiW0RFTEVURV0gR2V0dGluZyBNZW1vcnlNYW5hZ2VyIGluc3RhbmNlLi4uXCIpO1xyXG4gICAgY29uc3QgbWVtb3J5TWFuYWdlciA9IGF3YWl0IE1lbW9yeU1hbmFnZXIuZ2V0SW5zdGFuY2UobGxtKTtcclxuICAgIGNvbnNvbGUubG9nKFwiW0RFTEVURV0gTWVtb3J5TWFuYWdlciBpbnN0YW5jZSBvYnRhaW5lZC5cIik7XHJcblxyXG4gICAgLy8gQ3JlYXRlIGNvbXBhbmlvbktleSBhbmQgbG9nIGl0XHJcbiAgICBjb25zdCBjb21wYW5pb25LZXkgPSB7XHJcbiAgICAgIGNvbXBhbmlvbk5hbWU6IHBhcmFtcy5jb21wYW5pb25JZCxcclxuICAgICAgdXNlcklkOiB1c2VyLmlkLFxyXG4gICAgICBtb2RlbE5hbWU6IFwiZ3B0LTRvLW1pbmlcIixcclxuICAgIH07XHJcbiAgICBjb25zb2xlLmxvZyhcIltERUxFVEVdIENvbXBhbmlvbiBLZXkgY3JlYXRlZDpcIiwgY29tcGFuaW9uS2V5KTtcclxuXHJcbiAgICAvLyBMb2dnaW5nIG1lbW9yeSBjbGVhcmluZyBwcm9jZXNzXHJcbiAgICBjb25zb2xlLmxvZyhcIltERUxFVEVdIENsZWFyaW5nIG1lbW9yeSBoaXN0b3J5IGZvciBjb21wYW5pb246XCIsIGNvbXBhbmlvbktleS5jb21wYW5pb25OYW1lKTtcclxuICAgIGF3YWl0IG1lbW9yeU1hbmFnZXIuY2xlYXJIaXN0b3J5KGNvbXBhbmlvbktleSk7XHJcbiAgICBjb25zb2xlLmxvZyhcIltERUxFVEVdIE1lbW9yeSBoaXN0b3J5IGNsZWFyZWQgc3VjY2Vzc2Z1bGx5LlwiKTtcclxuXHJcbiAgICAvLyBMb2dnaW5nIFByaXNtYSBkZWxldGlvbiBwcm9jZXNzXHJcbiAgICBjb25zb2xlLmxvZyhcIltERUxFVEVdIERlbGV0aW5nIG1lc3NhZ2VzIGZyb20gUHJpc21hIGZvciBjb21wYW5pb25JZDpcIiwgcGFyYW1zLmNvbXBhbmlvbklkKTtcclxuICAgIGF3YWl0IHByaXNtYWRiLm1lc3NhZ2UuZGVsZXRlTWFueSh7XHJcbiAgICAgIHdoZXJlOiB7XHJcbiAgICAgICAgY29tcGFuaW9uSWQ6IHBhcmFtcy5jb21wYW5pb25JZCxcclxuICAgICAgICB1c2VySWQ6IHVzZXIuaWQsXHJcbiAgICAgIH0sXHJcbiAgICB9KTtcclxuICAgIGNvbnNvbGUubG9nKFwiW0RFTEVURV0gTWVzc2FnZXMgZGVsZXRlZCBmcm9tIFByaXNtYSBzdWNjZXNzZnVsbHkuXCIpO1xyXG5cclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IG1lc3NhZ2U6IFwiTWVzc2FnZSBoaXN0b3J5IGNsZWFyZWQgc3VjY2Vzc2Z1bGx5XCIgfSk7XHJcblxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiW0NPTVBBTklPTl9ISVNUT1JZX0RFTEVURV9FUlJPUl1cIiwgZXJyb3IpO1xyXG4gICAgcmV0dXJuIG5ldyBOZXh0UmVzcG9uc2UoXCJJbnRlcm5hbCBlcnJvclwiLCB7IHN0YXR1czogNTAwIH0pO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiTWVtb3J5TWFuYWdlciIsInByaXNtYWRiIiwiY3VycmVudFVzZXIiLCJOZXh0UmVzcG9uc2UiLCJDaGF0T3BlbkFJIiwiREVMRVRFIiwicmVxIiwicGFyYW1zIiwiY29uc29sZSIsImxvZyIsInVzZXIiLCJpZCIsImNvbXBhbmlvbklkIiwiZXJyb3IiLCJzdGF0dXMiLCJsbG0iLCJtb2RlbE5hbWUiLCJ0ZW1wZXJhdHVyZSIsIm9wZW5BSUFwaUtleSIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19PUEVOQUlfQVBJX0tFWSIsIm1lbW9yeU1hbmFnZXIiLCJnZXRJbnN0YW5jZSIsImNvbXBhbmlvbktleSIsImNvbXBhbmlvbk5hbWUiLCJ1c2VySWQiLCJjbGVhckhpc3RvcnkiLCJtZXNzYWdlIiwiZGVsZXRlTWFueSIsIndoZXJlIiwianNvbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/companion/[companionId]/history/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/memory.ts":
/*!***************************!*\
  !*** ./src/lib/memory.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   MemoryManager: () => (/* binding */ MemoryManager)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _langchain_community_vectorstores_faiss__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @langchain/community/vectorstores/faiss */ \"(rsc)/./node_modules/@langchain/community/vectorstores/faiss.js\");\n/* harmony import */ var _langchain_openai__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @langchain/openai */ \"(rsc)/./node_modules/@langchain/openai/index.js\");\n/* harmony import */ var langchain_experimental_generative_agents__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! langchain/experimental/generative_agents */ \"(rsc)/./node_modules/langchain/experimental/generative_agents.js\");\n/* harmony import */ var langchain_retrievers_time_weighted__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! langchain/retrievers/time_weighted */ \"(rsc)/./node_modules/langchain/retrievers/time_weighted.js\");\n/* harmony import */ var langchain_memory__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! langchain/memory */ \"(rsc)/./node_modules/langchain/memory.js\");\n//src\\lib\\memory.ts\n\n\n\n\n\n\nclass MemoryManager extends langchain_memory__WEBPACK_IMPORTED_MODULE_5__.BaseMemory {\n    constructor(llm){\n        super();\n        console.log(\"Initializing MemoryManager...\");\n        try {\n            this.prisma = new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient();\n            const embeddings = new _langchain_openai__WEBPACK_IMPORTED_MODULE_2__.OpenAIEmbeddings({\n                apiKey: \"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\"\n            });\n            const vectorStore = new _langchain_community_vectorstores_faiss__WEBPACK_IMPORTED_MODULE_1__.FaissStore(embeddings, {});\n            const memoryRetriever = new langchain_retrievers_time_weighted__WEBPACK_IMPORTED_MODULE_4__.TimeWeightedVectorStoreRetriever({\n                vectorStore: vectorStore,\n                otherScoreKeys: [\n                    \"importance\"\n                ],\n                k: 15\n            });\n            this.agentMemory = new langchain_experimental_generative_agents__WEBPACK_IMPORTED_MODULE_3__.GenerativeAgentMemory(llm, memoryRetriever, {\n                reflectionThreshold: 8,\n                importanceWeight: 0.15,\n                verbose: true,\n                maxTokensLimit: 1200\n            });\n            console.log(\"MemoryManager initialized successfully.\");\n        } catch (error) {\n            console.error(\"Error initializing MemoryManager:\", error);\n            throw new Error(\"Failed to initialize MemoryManager\");\n        }\n    }\n    get memoryKeys() {\n        return [\n            \"history\"\n        ];\n    }\n    async loadMemoryVariables(inputValues) {\n        console.log(\"Loading memory variables. Input:\", JSON.stringify(inputValues));\n        try {\n            const companionKey = inputValues.companionKey;\n            const latestHistory = await this.readLatestHistory(companionKey);\n            console.log(`Loaded ${latestHistory.length} history items.`);\n            return {\n                history: latestHistory\n            };\n        } catch (error) {\n            console.error(\"Error loading memory variables:\", error);\n            throw new Error(\"Failed to load memory variables\");\n        }\n    }\n    async saveContext(inputValues, outputValues) {\n        console.log(\"Saving context. Input:\", JSON.stringify(inputValues), \"Output:\", JSON.stringify(outputValues));\n        try {\n            const companionKey = inputValues.companionKey;\n            await this.writeToHistory(inputValues.input, companionKey);\n            if (outputValues.response) {\n                await this.writeToHistory(outputValues.response, companionKey);\n            }\n            console.log(\"Context saved successfully.\");\n        } catch (error) {\n            console.error(\"Error saving context:\", error);\n            throw new Error(\"Failed to save context\");\n        }\n    }\n    async clear() {\n        console.log(\"Clearing memory...\");\n        // Implement clearing logic if needed\n        console.log(\"Memory cleared.\");\n    }\n    async readLatestHistory(companionKey) {\n        console.log(`Reading latest history for companion: ${companionKey.companionName}, user: ${companionKey.userId}`);\n        try {\n            const messages = await this.prisma.message.findMany({\n                where: {\n                    userId: companionKey.userId,\n                    companionId: companionKey.companionName\n                },\n                orderBy: {\n                    createdAt: \"desc\"\n                },\n                take: 30\n            });\n            console.log(`Retrieved ${messages.length} messages from history.`);\n            return messages.map((msg)=>msg.content);\n        } catch (error) {\n            console.error(\"Error reading latest history:\", error);\n            throw new Error(\"Failed to read latest history\");\n        }\n    }\n    async writeToHistory(text, companionKey) {\n        console.log(`Writing to history for companion: ${companionKey.companionName}, user: ${companionKey.userId}`);\n        if (!companionKey.userId) {\n            console.error(\"Invalid companion key:\", companionKey);\n            throw new Error(\"Companion key set incorrectly\");\n        }\n        try {\n            await this.agentMemory.addMemory(text, new Date(), {\n                userId: companionKey.userId,\n                companionId: companionKey.companionName\n            });\n            console.log(\"Memory added to GenerativeAgentMemory.\");\n            await this.prisma.message.create({\n                data: {\n                    content: text,\n                    userId: companionKey.userId,\n                    companionId: companionKey.companionName,\n                    role: \"user\"\n                }\n            });\n            console.log(\"Message stored in Prisma database.\");\n        } catch (error) {\n            console.error(\"Error writing to history:\", error);\n            throw new Error(\"Failed to write to history\");\n        }\n    }\n    async vectorSearch(recentChatHistory, topK = 5) {\n        console.log(`Performing vector search with ${recentChatHistory.length} recent messages, top ${topK} results.`);\n        try {\n            const query = recentChatHistory.join(\" \");\n            const results = await this.agentMemory.memoryRetriever.invoke(query);\n            console.log(`Vector search returned ${results.length} results.`);\n            return results.map((doc)=>doc.pageContent);\n        } catch (error) {\n            console.error(\"Error during vector search:\", error);\n            throw new Error(\"Failed to perform vector search\");\n        }\n    }\n    async clearHistory(companionKey) {\n        console.log(`Clearing history for companion: ${companionKey.companionName}, user: ${companionKey.userId}`);\n        if (!companionKey.userId) {\n            console.error(\"Invalid companion key:\", companionKey);\n            throw new Error(\"Companion key set incorrectly\");\n        }\n        try {\n            const result = await this.prisma.message.deleteMany({\n                where: {\n                    userId: companionKey.userId,\n                    companionId: companionKey.companionName\n                }\n            });\n            console.log(`Cleared ${result.count} messages from history.`);\n        } catch (error) {\n            console.error(\"Error clearing history:\", error);\n            throw new Error(\"Failed to clear history\");\n        }\n    }\n    static async getInstance(llm) {\n        console.log(\"Getting MemoryManager instance...\");\n        if (!MemoryManager.instance) {\n            console.log(\"Creating new MemoryManager instance...\");\n            MemoryManager.instance = new MemoryManager(llm);\n        }\n        return MemoryManager.instance;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL21lbW9yeS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFBLG1CQUFtQjtBQUUyQjtBQUN1QjtBQUNoQjtBQUM0QjtBQUNLO0FBQ0k7QUFRbkYsTUFBTU0sc0JBQXNCRCx3REFBVUE7SUFLM0MsWUFBb0JFLEdBQVEsQ0FBRTtRQUM1QixLQUFLO1FBQ0xDLFFBQVFDLEdBQUcsQ0FBQztRQUNaLElBQUk7WUFDRixJQUFJLENBQUNDLE1BQU0sR0FBRyxJQUFJVix3REFBWUE7WUFDOUIsTUFBTVcsYUFBYSxJQUFJVCwrREFBZ0JBLENBQUM7Z0JBQUVVLFFBQVFDLHFEQUFzQztZQUFDO1lBRXpGLE1BQU1HLGNBQWMsSUFBSWYsK0VBQVVBLENBQUNVLFlBQVksQ0FBQztZQUNoRCxNQUFNTSxrQkFBa0IsSUFBSWIsZ0dBQWdDQSxDQUFDO2dCQUMzRFksYUFBYUE7Z0JBQ2JFLGdCQUFnQjtvQkFBQztpQkFBYTtnQkFDOUJDLEdBQUc7WUFDTDtZQUVBLElBQUksQ0FBQ0MsV0FBVyxHQUFHLElBQUlqQiwyRkFBcUJBLENBQzFDSSxLQUNBVSxpQkFDQTtnQkFDRUkscUJBQXFCO2dCQUNyQkMsa0JBQWtCO2dCQUNsQkMsU0FBUztnQkFDVEMsZ0JBQWdCO1lBQ2xCO1lBRUZoQixRQUFRQyxHQUFHLENBQUM7UUFDZCxFQUFFLE9BQU9nQixPQUFPO1lBQ2RqQixRQUFRaUIsS0FBSyxDQUFDLHFDQUFxQ0E7WUFDbkQsTUFBTSxJQUFJQyxNQUFNO1FBQ2xCO0lBQ0Y7SUFFQSxJQUFJQyxhQUF1QjtRQUN6QixPQUFPO1lBQUM7U0FBVTtJQUNwQjtJQUVBLE1BQU1DLG9CQUFvQkMsV0FBd0IsRUFBNEI7UUFDNUVyQixRQUFRQyxHQUFHLENBQUMsb0NBQW9DcUIsS0FBS0MsU0FBUyxDQUFDRjtRQUMvRCxJQUFJO1lBQ0YsTUFBTUcsZUFBZUgsWUFBWUcsWUFBWTtZQUM3QyxNQUFNQyxnQkFBZ0IsTUFBTSxJQUFJLENBQUNDLGlCQUFpQixDQUFDRjtZQUNuRHhCLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLE9BQU8sRUFBRXdCLGNBQWNFLE1BQU0sQ0FBQyxlQUFlLENBQUM7WUFDM0QsT0FBTztnQkFBRUMsU0FBU0g7WUFBYztRQUNsQyxFQUFFLE9BQU9SLE9BQU87WUFDZGpCLFFBQVFpQixLQUFLLENBQUMsbUNBQW1DQTtZQUNqRCxNQUFNLElBQUlDLE1BQU07UUFDbEI7SUFDRjtJQUVBLE1BQU1XLFlBQVlSLFdBQXdCLEVBQUVTLFlBQTBCLEVBQWlCO1FBQ3JGOUIsUUFBUUMsR0FBRyxDQUFDLDBCQUEwQnFCLEtBQUtDLFNBQVMsQ0FBQ0YsY0FBYyxXQUFXQyxLQUFLQyxTQUFTLENBQUNPO1FBQzdGLElBQUk7WUFDRixNQUFNTixlQUFlSCxZQUFZRyxZQUFZO1lBQzdDLE1BQU0sSUFBSSxDQUFDTyxjQUFjLENBQUNWLFlBQVlXLEtBQUssRUFBWVI7WUFDdkQsSUFBSU0sYUFBYUcsUUFBUSxFQUFFO2dCQUN6QixNQUFNLElBQUksQ0FBQ0YsY0FBYyxDQUFDRCxhQUFhRyxRQUFRLEVBQVlUO1lBQzdEO1lBQ0F4QixRQUFRQyxHQUFHLENBQUM7UUFDZCxFQUFFLE9BQU9nQixPQUFPO1lBQ2RqQixRQUFRaUIsS0FBSyxDQUFDLHlCQUF5QkE7WUFDdkMsTUFBTSxJQUFJQyxNQUFNO1FBQ2xCO0lBQ0Y7SUFFQSxNQUFNZ0IsUUFBdUI7UUFDM0JsQyxRQUFRQyxHQUFHLENBQUM7UUFDWixxQ0FBcUM7UUFDckNELFFBQVFDLEdBQUcsQ0FBQztJQUNkO0lBRUEsTUFBYXlCLGtCQUFrQkYsWUFBMEIsRUFBcUI7UUFDNUV4QixRQUFRQyxHQUFHLENBQUMsQ0FBQyxzQ0FBc0MsRUFBRXVCLGFBQWFXLGFBQWEsQ0FBQyxRQUFRLEVBQUVYLGFBQWFZLE1BQU0sQ0FBQyxDQUFDO1FBQy9HLElBQUk7WUFDRixNQUFNQyxXQUFXLE1BQU0sSUFBSSxDQUFDbkMsTUFBTSxDQUFDb0MsT0FBTyxDQUFDQyxRQUFRLENBQUM7Z0JBQ2xEQyxPQUFPO29CQUNMSixRQUFRWixhQUFhWSxNQUFNO29CQUMzQkssYUFBYWpCLGFBQWFXLGFBQWE7Z0JBQ3pDO2dCQUNBTyxTQUFTO29CQUFFQyxXQUFXO2dCQUFPO2dCQUM3QkMsTUFBTTtZQUNSO1lBQ0E1QyxRQUFRQyxHQUFHLENBQUMsQ0FBQyxVQUFVLEVBQUVvQyxTQUFTVixNQUFNLENBQUMsdUJBQXVCLENBQUM7WUFDakUsT0FBT1UsU0FBU1EsR0FBRyxDQUFDQyxDQUFBQSxNQUFPQSxJQUFJQyxPQUFPO1FBQ3hDLEVBQUUsT0FBTzlCLE9BQU87WUFDZGpCLFFBQVFpQixLQUFLLENBQUMsaUNBQWlDQTtZQUMvQyxNQUFNLElBQUlDLE1BQU07UUFDbEI7SUFDRjtJQUVBLE1BQWFhLGVBQWVpQixJQUFZLEVBQUV4QixZQUEwQixFQUFpQjtRQUNuRnhCLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLGtDQUFrQyxFQUFFdUIsYUFBYVcsYUFBYSxDQUFDLFFBQVEsRUFBRVgsYUFBYVksTUFBTSxDQUFDLENBQUM7UUFDM0csSUFBSSxDQUFDWixhQUFhWSxNQUFNLEVBQUU7WUFDeEJwQyxRQUFRaUIsS0FBSyxDQUFDLDBCQUEwQk87WUFDeEMsTUFBTSxJQUFJTixNQUFNO1FBQ2xCO1FBQ0EsSUFBSTtZQUNGLE1BQU0sSUFBSSxDQUFDTixXQUFXLENBQUNxQyxTQUFTLENBQUNELE1BQU0sSUFBSUUsUUFBUTtnQkFDakRkLFFBQVFaLGFBQWFZLE1BQU07Z0JBQzNCSyxhQUFhakIsYUFBYVcsYUFBYTtZQUN6QztZQUNBbkMsUUFBUUMsR0FBRyxDQUFDO1lBRVosTUFBTSxJQUFJLENBQUNDLE1BQU0sQ0FBQ29DLE9BQU8sQ0FBQ2EsTUFBTSxDQUFDO2dCQUMvQkMsTUFBTTtvQkFDSkwsU0FBU0M7b0JBQ1RaLFFBQVFaLGFBQWFZLE1BQU07b0JBQzNCSyxhQUFhakIsYUFBYVcsYUFBYTtvQkFDdkNrQixNQUFNO2dCQUNSO1lBQ0Y7WUFDQXJELFFBQVFDLEdBQUcsQ0FBQztRQUNkLEVBQUUsT0FBT2dCLE9BQU87WUFDZGpCLFFBQVFpQixLQUFLLENBQUMsNkJBQTZCQTtZQUMzQyxNQUFNLElBQUlDLE1BQU07UUFDbEI7SUFDRjtJQUVBLE1BQWFvQyxhQUFhQyxpQkFBMkIsRUFBRUMsT0FBZSxDQUFDLEVBQXFCO1FBQzFGeEQsUUFBUUMsR0FBRyxDQUFDLENBQUMsOEJBQThCLEVBQUVzRCxrQkFBa0I1QixNQUFNLENBQUMsc0JBQXNCLEVBQUU2QixLQUFLLFNBQVMsQ0FBQztRQUM3RyxJQUFJO1lBQ0YsTUFBTUMsUUFBUUYsa0JBQWtCRyxJQUFJLENBQUM7WUFDckMsTUFBTUMsVUFBVSxNQUFNLElBQUksQ0FBQy9DLFdBQVcsQ0FBQ0gsZUFBZSxDQUFDbUQsTUFBTSxDQUFDSDtZQUM5RHpELFFBQVFDLEdBQUcsQ0FBQyxDQUFDLHVCQUF1QixFQUFFMEQsUUFBUWhDLE1BQU0sQ0FBQyxTQUFTLENBQUM7WUFDL0QsT0FBT2dDLFFBQVFkLEdBQUcsQ0FBQ2dCLENBQUFBLE1BQU9BLElBQUlDLFdBQVc7UUFDM0MsRUFBRSxPQUFPN0MsT0FBTztZQUNkakIsUUFBUWlCLEtBQUssQ0FBQywrQkFBK0JBO1lBQzdDLE1BQU0sSUFBSUMsTUFBTTtRQUNsQjtJQUNGO0lBRUEsTUFBYTZDLGFBQWF2QyxZQUEwQixFQUFpQjtRQUNuRXhCLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLGdDQUFnQyxFQUFFdUIsYUFBYVcsYUFBYSxDQUFDLFFBQVEsRUFBRVgsYUFBYVksTUFBTSxDQUFDLENBQUM7UUFDekcsSUFBSSxDQUFDWixhQUFhWSxNQUFNLEVBQUU7WUFDeEJwQyxRQUFRaUIsS0FBSyxDQUFDLDBCQUEwQk87WUFDeEMsTUFBTSxJQUFJTixNQUFNO1FBQ2xCO1FBQ0EsSUFBSTtZQUNGLE1BQU04QyxTQUFTLE1BQU0sSUFBSSxDQUFDOUQsTUFBTSxDQUFDb0MsT0FBTyxDQUFDMkIsVUFBVSxDQUFDO2dCQUNsRHpCLE9BQU87b0JBQ0xKLFFBQVFaLGFBQWFZLE1BQU07b0JBQzNCSyxhQUFhakIsYUFBYVcsYUFBYTtnQkFDekM7WUFDRjtZQUNBbkMsUUFBUUMsR0FBRyxDQUFDLENBQUMsUUFBUSxFQUFFK0QsT0FBT0UsS0FBSyxDQUFDLHVCQUF1QixDQUFDO1FBQzlELEVBQUUsT0FBT2pELE9BQU87WUFDZGpCLFFBQVFpQixLQUFLLENBQUMsMkJBQTJCQTtZQUN6QyxNQUFNLElBQUlDLE1BQU07UUFDbEI7SUFDRjtJQUVBLGFBQW9CaUQsWUFBWXBFLEdBQVEsRUFBMEI7UUFDaEVDLFFBQVFDLEdBQUcsQ0FBQztRQUNaLElBQUksQ0FBQ0gsY0FBY3NFLFFBQVEsRUFBRTtZQUMzQnBFLFFBQVFDLEdBQUcsQ0FBQztZQUNaSCxjQUFjc0UsUUFBUSxHQUFHLElBQUl0RSxjQUFjQztRQUM3QztRQUNBLE9BQU9ELGNBQWNzRSxRQUFRO0lBQy9CO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9haS1jb21wYW5pb24vLi9zcmMvbGliL21lbW9yeS50cz85M2VlIl0sInNvdXJjZXNDb250ZW50IjpbIi8vc3JjXFxsaWJcXG1lbW9yeS50c1xyXG5cclxuaW1wb3J0IHsgUHJpc21hQ2xpZW50IH0gZnJvbSAnQHByaXNtYS9jbGllbnQnO1xyXG5pbXBvcnQgeyBGYWlzc1N0b3JlIH0gZnJvbSBcIkBsYW5nY2hhaW4vY29tbXVuaXR5L3ZlY3RvcnN0b3Jlcy9mYWlzc1wiO1xyXG5pbXBvcnQgeyBPcGVuQUlFbWJlZGRpbmdzIH0gZnJvbSAnQGxhbmdjaGFpbi9vcGVuYWknO1xyXG5pbXBvcnQgeyBHZW5lcmF0aXZlQWdlbnRNZW1vcnkgfSBmcm9tIFwibGFuZ2NoYWluL2V4cGVyaW1lbnRhbC9nZW5lcmF0aXZlX2FnZW50c1wiO1xyXG5pbXBvcnQgeyBUaW1lV2VpZ2h0ZWRWZWN0b3JTdG9yZVJldHJpZXZlciB9IGZyb20gXCJsYW5nY2hhaW4vcmV0cmlldmVycy90aW1lX3dlaWdodGVkXCI7XHJcbmltcG9ydCB7IEJhc2VNZW1vcnksIElucHV0VmFsdWVzLCBNZW1vcnlWYXJpYWJsZXMsIE91dHB1dFZhbHVlcyB9IGZyb20gXCJsYW5nY2hhaW4vbWVtb3J5XCI7XHJcblxyXG5leHBvcnQgdHlwZSBDb21wYW5pb25LZXkgPSB7XHJcbiAgY29tcGFuaW9uTmFtZTogc3RyaW5nO1xyXG4gIG1vZGVsTmFtZTogc3RyaW5nO1xyXG4gIHVzZXJJZDogc3RyaW5nO1xyXG59O1xyXG5cclxuZXhwb3J0IGNsYXNzIE1lbW9yeU1hbmFnZXIgZXh0ZW5kcyBCYXNlTWVtb3J5IHtcclxuICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogTWVtb3J5TWFuYWdlcjtcclxuICBwcml2YXRlIHByaXNtYTogUHJpc21hQ2xpZW50O1xyXG4gIHByaXZhdGUgYWdlbnRNZW1vcnk6IEdlbmVyYXRpdmVBZ2VudE1lbW9yeTtcclxuXHJcbiAgcHJpdmF0ZSBjb25zdHJ1Y3RvcihsbG06IGFueSkge1xyXG4gICAgc3VwZXIoKTtcclxuICAgIGNvbnNvbGUubG9nKFwiSW5pdGlhbGl6aW5nIE1lbW9yeU1hbmFnZXIuLi5cIik7XHJcbiAgICB0cnkge1xyXG4gICAgICB0aGlzLnByaXNtYSA9IG5ldyBQcmlzbWFDbGllbnQoKTtcclxuICAgICAgY29uc3QgZW1iZWRkaW5ncyA9IG5ldyBPcGVuQUlFbWJlZGRpbmdzKHsgYXBpS2V5OiBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19PUEVOQUlfQVBJX0tFWSB9KTtcclxuXHJcbiAgICAgIGNvbnN0IHZlY3RvclN0b3JlID0gbmV3IEZhaXNzU3RvcmUoZW1iZWRkaW5ncywge30pO1xyXG4gICAgICBjb25zdCBtZW1vcnlSZXRyaWV2ZXIgPSBuZXcgVGltZVdlaWdodGVkVmVjdG9yU3RvcmVSZXRyaWV2ZXIoe1xyXG4gICAgICAgIHZlY3RvclN0b3JlOiB2ZWN0b3JTdG9yZSxcclxuICAgICAgICBvdGhlclNjb3JlS2V5czogW1wiaW1wb3J0YW5jZVwiXSxcclxuICAgICAgICBrOiAxNSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICB0aGlzLmFnZW50TWVtb3J5ID0gbmV3IEdlbmVyYXRpdmVBZ2VudE1lbW9yeShcclxuICAgICAgICBsbG0sXHJcbiAgICAgICAgbWVtb3J5UmV0cmlldmVyLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIHJlZmxlY3Rpb25UaHJlc2hvbGQ6IDgsXHJcbiAgICAgICAgICBpbXBvcnRhbmNlV2VpZ2h0OiAwLjE1LFxyXG4gICAgICAgICAgdmVyYm9zZTogdHJ1ZSxcclxuICAgICAgICAgIG1heFRva2Vuc0xpbWl0OiAxMjAwLFxyXG4gICAgICAgIH1cclxuICAgICAgKTtcclxuICAgICAgY29uc29sZS5sb2coXCJNZW1vcnlNYW5hZ2VyIGluaXRpYWxpemVkIHN1Y2Nlc3NmdWxseS5cIik7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgaW5pdGlhbGl6aW5nIE1lbW9yeU1hbmFnZXI6XCIsIGVycm9yKTtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIGluaXRpYWxpemUgTWVtb3J5TWFuYWdlclwiKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGdldCBtZW1vcnlLZXlzKCk6IHN0cmluZ1tdIHtcclxuICAgIHJldHVybiBbJ2hpc3RvcnknXTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGxvYWRNZW1vcnlWYXJpYWJsZXMoaW5wdXRWYWx1ZXM6IElucHV0VmFsdWVzKTogUHJvbWlzZTxNZW1vcnlWYXJpYWJsZXM+IHtcclxuICAgIGNvbnNvbGUubG9nKFwiTG9hZGluZyBtZW1vcnkgdmFyaWFibGVzLiBJbnB1dDpcIiwgSlNPTi5zdHJpbmdpZnkoaW5wdXRWYWx1ZXMpKTtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IGNvbXBhbmlvbktleSA9IGlucHV0VmFsdWVzLmNvbXBhbmlvbktleSBhcyBDb21wYW5pb25LZXk7XHJcbiAgICAgIGNvbnN0IGxhdGVzdEhpc3RvcnkgPSBhd2FpdCB0aGlzLnJlYWRMYXRlc3RIaXN0b3J5KGNvbXBhbmlvbktleSk7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBMb2FkZWQgJHtsYXRlc3RIaXN0b3J5Lmxlbmd0aH0gaGlzdG9yeSBpdGVtcy5gKTtcclxuICAgICAgcmV0dXJuIHsgaGlzdG9yeTogbGF0ZXN0SGlzdG9yeSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGxvYWRpbmcgbWVtb3J5IHZhcmlhYmxlczpcIiwgZXJyb3IpO1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gbG9hZCBtZW1vcnkgdmFyaWFibGVzXCIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgc2F2ZUNvbnRleHQoaW5wdXRWYWx1ZXM6IElucHV0VmFsdWVzLCBvdXRwdXRWYWx1ZXM6IE91dHB1dFZhbHVlcyk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgY29uc29sZS5sb2coXCJTYXZpbmcgY29udGV4dC4gSW5wdXQ6XCIsIEpTT04uc3RyaW5naWZ5KGlucHV0VmFsdWVzKSwgXCJPdXRwdXQ6XCIsIEpTT04uc3RyaW5naWZ5KG91dHB1dFZhbHVlcykpO1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgY29tcGFuaW9uS2V5ID0gaW5wdXRWYWx1ZXMuY29tcGFuaW9uS2V5IGFzIENvbXBhbmlvbktleTtcclxuICAgICAgYXdhaXQgdGhpcy53cml0ZVRvSGlzdG9yeShpbnB1dFZhbHVlcy5pbnB1dCBhcyBzdHJpbmcsIGNvbXBhbmlvbktleSk7XHJcbiAgICAgIGlmIChvdXRwdXRWYWx1ZXMucmVzcG9uc2UpIHtcclxuICAgICAgICBhd2FpdCB0aGlzLndyaXRlVG9IaXN0b3J5KG91dHB1dFZhbHVlcy5yZXNwb25zZSBhcyBzdHJpbmcsIGNvbXBhbmlvbktleSk7XHJcbiAgICAgIH1cclxuICAgICAgY29uc29sZS5sb2coXCJDb250ZXh0IHNhdmVkIHN1Y2Nlc3NmdWxseS5cIik7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3Igc2F2aW5nIGNvbnRleHQ6XCIsIGVycm9yKTtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIHNhdmUgY29udGV4dFwiKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGFzeW5jIGNsZWFyKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgY29uc29sZS5sb2coXCJDbGVhcmluZyBtZW1vcnkuLi5cIik7XHJcbiAgICAvLyBJbXBsZW1lbnQgY2xlYXJpbmcgbG9naWMgaWYgbmVlZGVkXHJcbiAgICBjb25zb2xlLmxvZyhcIk1lbW9yeSBjbGVhcmVkLlwiKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBhc3luYyByZWFkTGF0ZXN0SGlzdG9yeShjb21wYW5pb25LZXk6IENvbXBhbmlvbktleSk6IFByb21pc2U8c3RyaW5nW10+IHtcclxuICAgIGNvbnNvbGUubG9nKGBSZWFkaW5nIGxhdGVzdCBoaXN0b3J5IGZvciBjb21wYW5pb246ICR7Y29tcGFuaW9uS2V5LmNvbXBhbmlvbk5hbWV9LCB1c2VyOiAke2NvbXBhbmlvbktleS51c2VySWR9YCk7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBtZXNzYWdlcyA9IGF3YWl0IHRoaXMucHJpc21hLm1lc3NhZ2UuZmluZE1hbnkoe1xyXG4gICAgICAgIHdoZXJlOiB7XHJcbiAgICAgICAgICB1c2VySWQ6IGNvbXBhbmlvbktleS51c2VySWQsXHJcbiAgICAgICAgICBjb21wYW5pb25JZDogY29tcGFuaW9uS2V5LmNvbXBhbmlvbk5hbWUsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sXHJcbiAgICAgICAgdGFrZTogMzAsXHJcbiAgICAgIH0pO1xyXG4gICAgICBjb25zb2xlLmxvZyhgUmV0cmlldmVkICR7bWVzc2FnZXMubGVuZ3RofSBtZXNzYWdlcyBmcm9tIGhpc3RvcnkuYCk7XHJcbiAgICAgIHJldHVybiBtZXNzYWdlcy5tYXAobXNnID0+IG1zZy5jb250ZW50KTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciByZWFkaW5nIGxhdGVzdCBoaXN0b3J5OlwiLCBlcnJvcik7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkZhaWxlZCB0byByZWFkIGxhdGVzdCBoaXN0b3J5XCIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHVibGljIGFzeW5jIHdyaXRlVG9IaXN0b3J5KHRleHQ6IHN0cmluZywgY29tcGFuaW9uS2V5OiBDb21wYW5pb25LZXkpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGNvbnNvbGUubG9nKGBXcml0aW5nIHRvIGhpc3RvcnkgZm9yIGNvbXBhbmlvbjogJHtjb21wYW5pb25LZXkuY29tcGFuaW9uTmFtZX0sIHVzZXI6ICR7Y29tcGFuaW9uS2V5LnVzZXJJZH1gKTtcclxuICAgIGlmICghY29tcGFuaW9uS2V5LnVzZXJJZCkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiSW52YWxpZCBjb21wYW5pb24ga2V5OlwiLCBjb21wYW5pb25LZXkpO1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDb21wYW5pb24ga2V5IHNldCBpbmNvcnJlY3RseVwiKTtcclxuICAgIH1cclxuICAgIHRyeSB7XHJcbiAgICAgIGF3YWl0IHRoaXMuYWdlbnRNZW1vcnkuYWRkTWVtb3J5KHRleHQsIG5ldyBEYXRlKCksIHtcclxuICAgICAgICB1c2VySWQ6IGNvbXBhbmlvbktleS51c2VySWQsXHJcbiAgICAgICAgY29tcGFuaW9uSWQ6IGNvbXBhbmlvbktleS5jb21wYW5pb25OYW1lLFxyXG4gICAgICB9KTtcclxuICAgICAgY29uc29sZS5sb2coXCJNZW1vcnkgYWRkZWQgdG8gR2VuZXJhdGl2ZUFnZW50TWVtb3J5LlwiKTtcclxuXHJcbiAgICAgIGF3YWl0IHRoaXMucHJpc21hLm1lc3NhZ2UuY3JlYXRlKHtcclxuICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICBjb250ZW50OiB0ZXh0LFxyXG4gICAgICAgICAgdXNlcklkOiBjb21wYW5pb25LZXkudXNlcklkLFxyXG4gICAgICAgICAgY29tcGFuaW9uSWQ6IGNvbXBhbmlvbktleS5jb21wYW5pb25OYW1lLFxyXG4gICAgICAgICAgcm9sZTogJ3VzZXInLCAvLyBDb25zaWRlciBkeW5hbWljYWxseSBzZXR0aW5nIHRoaXMgYmFzZWQgb24gdGhlIGFjdHVhbCByb2xlXHJcbiAgICAgICAgfSxcclxuICAgICAgfSk7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwiTWVzc2FnZSBzdG9yZWQgaW4gUHJpc21hIGRhdGFiYXNlLlwiKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciB3cml0aW5nIHRvIGhpc3Rvcnk6XCIsIGVycm9yKTtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIHdyaXRlIHRvIGhpc3RvcnlcIik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgYXN5bmMgdmVjdG9yU2VhcmNoKHJlY2VudENoYXRIaXN0b3J5OiBzdHJpbmdbXSwgdG9wSzogbnVtYmVyID0gNSk6IFByb21pc2U8c3RyaW5nW10+IHtcclxuICAgIGNvbnNvbGUubG9nKGBQZXJmb3JtaW5nIHZlY3RvciBzZWFyY2ggd2l0aCAke3JlY2VudENoYXRIaXN0b3J5Lmxlbmd0aH0gcmVjZW50IG1lc3NhZ2VzLCB0b3AgJHt0b3BLfSByZXN1bHRzLmApO1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcXVlcnkgPSByZWNlbnRDaGF0SGlzdG9yeS5qb2luKFwiIFwiKTtcclxuICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IHRoaXMuYWdlbnRNZW1vcnkubWVtb3J5UmV0cmlldmVyLmludm9rZShxdWVyeSk7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBWZWN0b3Igc2VhcmNoIHJldHVybmVkICR7cmVzdWx0cy5sZW5ndGh9IHJlc3VsdHMuYCk7XHJcbiAgICAgIHJldHVybiByZXN1bHRzLm1hcChkb2MgPT4gZG9jLnBhZ2VDb250ZW50KTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBkdXJpbmcgdmVjdG9yIHNlYXJjaDpcIiwgZXJyb3IpO1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gcGVyZm9ybSB2ZWN0b3Igc2VhcmNoXCIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHVibGljIGFzeW5jIGNsZWFySGlzdG9yeShjb21wYW5pb25LZXk6IENvbXBhbmlvbktleSk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgY29uc29sZS5sb2coYENsZWFyaW5nIGhpc3RvcnkgZm9yIGNvbXBhbmlvbjogJHtjb21wYW5pb25LZXkuY29tcGFuaW9uTmFtZX0sIHVzZXI6ICR7Y29tcGFuaW9uS2V5LnVzZXJJZH1gKTtcclxuICAgIGlmICghY29tcGFuaW9uS2V5LnVzZXJJZCkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiSW52YWxpZCBjb21wYW5pb24ga2V5OlwiLCBjb21wYW5pb25LZXkpO1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDb21wYW5pb24ga2V5IHNldCBpbmNvcnJlY3RseVwiKTtcclxuICAgIH1cclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucHJpc21hLm1lc3NhZ2UuZGVsZXRlTWFueSh7XHJcbiAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgIHVzZXJJZDogY29tcGFuaW9uS2V5LnVzZXJJZCxcclxuICAgICAgICAgIGNvbXBhbmlvbklkOiBjb21wYW5pb25LZXkuY29tcGFuaW9uTmFtZSxcclxuICAgICAgICB9LFxyXG4gICAgICB9KTtcclxuICAgICAgY29uc29sZS5sb2coYENsZWFyZWQgJHtyZXN1bHQuY291bnR9IG1lc3NhZ2VzIGZyb20gaGlzdG9yeS5gKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBjbGVhcmluZyBoaXN0b3J5OlwiLCBlcnJvcik7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkZhaWxlZCB0byBjbGVhciBoaXN0b3J5XCIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHVibGljIHN0YXRpYyBhc3luYyBnZXRJbnN0YW5jZShsbG06IGFueSk6IFByb21pc2U8TWVtb3J5TWFuYWdlcj4ge1xyXG4gICAgY29uc29sZS5sb2coXCJHZXR0aW5nIE1lbW9yeU1hbmFnZXIgaW5zdGFuY2UuLi5cIik7XHJcbiAgICBpZiAoIU1lbW9yeU1hbmFnZXIuaW5zdGFuY2UpIHtcclxuICAgICAgY29uc29sZS5sb2coXCJDcmVhdGluZyBuZXcgTWVtb3J5TWFuYWdlciBpbnN0YW5jZS4uLlwiKTtcclxuICAgICAgTWVtb3J5TWFuYWdlci5pbnN0YW5jZSA9IG5ldyBNZW1vcnlNYW5hZ2VyKGxsbSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gTWVtb3J5TWFuYWdlci5pbnN0YW5jZTtcclxuICB9XHJcbn0iXSwibmFtZXMiOlsiUHJpc21hQ2xpZW50IiwiRmFpc3NTdG9yZSIsIk9wZW5BSUVtYmVkZGluZ3MiLCJHZW5lcmF0aXZlQWdlbnRNZW1vcnkiLCJUaW1lV2VpZ2h0ZWRWZWN0b3JTdG9yZVJldHJpZXZlciIsIkJhc2VNZW1vcnkiLCJNZW1vcnlNYW5hZ2VyIiwibGxtIiwiY29uc29sZSIsImxvZyIsInByaXNtYSIsImVtYmVkZGluZ3MiLCJhcGlLZXkiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfT1BFTkFJX0FQSV9LRVkiLCJ2ZWN0b3JTdG9yZSIsIm1lbW9yeVJldHJpZXZlciIsIm90aGVyU2NvcmVLZXlzIiwiayIsImFnZW50TWVtb3J5IiwicmVmbGVjdGlvblRocmVzaG9sZCIsImltcG9ydGFuY2VXZWlnaHQiLCJ2ZXJib3NlIiwibWF4VG9rZW5zTGltaXQiLCJlcnJvciIsIkVycm9yIiwibWVtb3J5S2V5cyIsImxvYWRNZW1vcnlWYXJpYWJsZXMiLCJpbnB1dFZhbHVlcyIsIkpTT04iLCJzdHJpbmdpZnkiLCJjb21wYW5pb25LZXkiLCJsYXRlc3RIaXN0b3J5IiwicmVhZExhdGVzdEhpc3RvcnkiLCJsZW5ndGgiLCJoaXN0b3J5Iiwic2F2ZUNvbnRleHQiLCJvdXRwdXRWYWx1ZXMiLCJ3cml0ZVRvSGlzdG9yeSIsImlucHV0IiwicmVzcG9uc2UiLCJjbGVhciIsImNvbXBhbmlvbk5hbWUiLCJ1c2VySWQiLCJtZXNzYWdlcyIsIm1lc3NhZ2UiLCJmaW5kTWFueSIsIndoZXJlIiwiY29tcGFuaW9uSWQiLCJvcmRlckJ5IiwiY3JlYXRlZEF0IiwidGFrZSIsIm1hcCIsIm1zZyIsImNvbnRlbnQiLCJ0ZXh0IiwiYWRkTWVtb3J5IiwiRGF0ZSIsImNyZWF0ZSIsImRhdGEiLCJyb2xlIiwidmVjdG9yU2VhcmNoIiwicmVjZW50Q2hhdEhpc3RvcnkiLCJ0b3BLIiwicXVlcnkiLCJqb2luIiwicmVzdWx0cyIsImludm9rZSIsImRvYyIsInBhZ2VDb250ZW50IiwiY2xlYXJIaXN0b3J5IiwicmVzdWx0IiwiZGVsZXRlTWFueSIsImNvdW50IiwiZ2V0SW5zdGFuY2UiLCJpbnN0YW5jZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/memory.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/prismadb.ts":
/*!*****************************!*\
  !*** ./src/lib/prismadb.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _prisma_extension_accelerate__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @prisma/extension-accelerate */ \"(rsc)/./node_modules/@prisma/extension-accelerate/dist/esm/entry.node.js\");\n/* harmony import */ var dotenv__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! dotenv */ \"(rsc)/./node_modules/dotenv/lib/main.js\");\n/* harmony import */ var dotenv__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(dotenv__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_3__);\n// src/lib/prismadb.ts\n\n\n\n\n// Load the .env.local file\ndotenv__WEBPACK_IMPORTED_MODULE_2___default().config({\n    path: path__WEBPACK_IMPORTED_MODULE_3___default().resolve(__dirname, \"../../.env.local\")\n});\nconst prismaClientSingleton = ()=>{\n    return new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient().$extends((0,_prisma_extension_accelerate__WEBPACK_IMPORTED_MODULE_1__.withAccelerate)());\n};\nconst prisma = global.prismaGlobal ?? prismaClientSingleton();\nif (true) global.prismaGlobal = prisma;\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (prisma);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3ByaXNtYWRiLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQUEsc0JBQXNCO0FBRXdCO0FBQ2dCO0FBQ2xDO0FBQ0o7QUFFeEIsMkJBQTJCO0FBQzNCRSxvREFBYSxDQUFDO0lBQUVDLE1BQU1BLG1EQUFZLENBQUNHLFdBQVc7QUFBb0I7QUFFbEUsTUFBTUMsd0JBQXdCO0lBQzVCLE9BQU8sSUFBSVAsd0RBQVlBLEdBQUdRLFFBQVEsQ0FBQ1AsNEVBQWNBO0FBQ25EO0FBT0EsTUFBTVEsU0FBU0MsT0FBT0MsWUFBWSxJQUFJSjtBQUV0QyxJQUFJSyxJQUF5QixFQUFjRixPQUFPQyxZQUFZLEdBQUdGO0FBRWpFLGlFQUFlQSxNQUFNQSxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWktY29tcGFuaW9uLy4vc3JjL2xpYi9wcmlzbWFkYi50cz85ZmVjIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9saWIvcHJpc21hZGIudHNcclxuXHJcbmltcG9ydCB7IFByaXNtYUNsaWVudCB9IGZyb20gJ0BwcmlzbWEvY2xpZW50JztcclxuaW1wb3J0IHsgd2l0aEFjY2VsZXJhdGUgfSBmcm9tICdAcHJpc21hL2V4dGVuc2lvbi1hY2NlbGVyYXRlJztcclxuaW1wb3J0IGRvdGVudiBmcm9tICdkb3RlbnYnO1xyXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcclxuXHJcbi8vIExvYWQgdGhlIC5lbnYubG9jYWwgZmlsZVxyXG5kb3RlbnYuY29uZmlnKHsgcGF0aDogcGF0aC5yZXNvbHZlKF9fZGlybmFtZSwgJy4uLy4uLy5lbnYubG9jYWwnKSB9KTtcclxuXHJcbmNvbnN0IHByaXNtYUNsaWVudFNpbmdsZXRvbiA9ICgpID0+IHtcclxuICByZXR1cm4gbmV3IFByaXNtYUNsaWVudCgpLiRleHRlbmRzKHdpdGhBY2NlbGVyYXRlKCkpO1xyXG59XHJcblxyXG5kZWNsYXJlIGdsb2JhbCB7XHJcbiAgLy8gRXh0ZW5kaW5nIHRoZSBOb2RlSlMgZ2xvYmFsIGludGVyZmFjZVxyXG4gIHZhciBwcmlzbWFHbG9iYWw6IFJldHVyblR5cGU8dHlwZW9mIHByaXNtYUNsaWVudFNpbmdsZXRvbj4gfCB1bmRlZmluZWQ7XHJcbn1cclxuXHJcbmNvbnN0IHByaXNtYSA9IGdsb2JhbC5wcmlzbWFHbG9iYWwgPz8gcHJpc21hQ2xpZW50U2luZ2xldG9uKCk7XHJcblxyXG5pZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgZ2xvYmFsLnByaXNtYUdsb2JhbCA9IHByaXNtYTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IHByaXNtYTtcclxuIl0sIm5hbWVzIjpbIlByaXNtYUNsaWVudCIsIndpdGhBY2NlbGVyYXRlIiwiZG90ZW52IiwicGF0aCIsImNvbmZpZyIsInJlc29sdmUiLCJfX2Rpcm5hbWUiLCJwcmlzbWFDbGllbnRTaW5nbGV0b24iLCIkZXh0ZW5kcyIsInByaXNtYSIsImdsb2JhbCIsInByaXNtYUdsb2JhbCIsInByb2Nlc3MiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/prismadb.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/langchain","vendor-chunks/next","vendor-chunks/@clerk","vendor-chunks/crypto-js","vendor-chunks/tslib","vendor-chunks/@prisma","vendor-chunks/dotenv","vendor-chunks/ms","vendor-chunks/cookie","vendor-chunks/map-obj","vendor-chunks/no-case","vendor-chunks/lower-case","vendor-chunks/snakecase-keys","vendor-chunks/snake-case","vendor-chunks/dot-case","vendor-chunks/@langchain","vendor-chunks/formdata-node","vendor-chunks/tr46","vendor-chunks/openai","vendor-chunks/web-streams-polyfill","vendor-chunks/zod","vendor-chunks/langsmith","vendor-chunks/semver","vendor-chunks/zod-to-json-schema","vendor-chunks/node-fetch","vendor-chunks/whatwg-url","vendor-chunks/event-target-shim","vendor-chunks/mustache","vendor-chunks/agentkeepalive","vendor-chunks/p-queue","vendor-chunks/form-data-encoder","vendor-chunks/eventemitter3","vendor-chunks/js-tiktoken","vendor-chunks/retry","vendor-chunks/webidl-conversions","vendor-chunks/base64-js","vendor-chunks/ansi-styles","vendor-chunks/abort-controller","vendor-chunks/camelcase","vendor-chunks/uuid","vendor-chunks/p-retry","vendor-chunks/p-timeout","vendor-chunks/humanize-ms","vendor-chunks/decamelize","vendor-chunks/p-finally"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcompanion%2F%5BcompanionId%5D%2Fhistory%2Froute&page=%2Fapi%2Fcompanion%2F%5BcompanionId%5D%2Fhistory%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcompanion%2F%5BcompanionId%5D%2Fhistory%2Froute.ts&appDir=C%3A%5CAI_src%5CCompanion_UI%5CSaaS-AI-Companion%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CAI_src%5CCompanion_UI%5CSaaS-AI-Companion&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();